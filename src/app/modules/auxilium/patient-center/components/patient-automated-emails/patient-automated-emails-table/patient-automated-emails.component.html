<div class="flex w-full flex-col" style="height: 695px; overflow-y: scroll">
    <div class="relative flex min-w-0 flex-auto flex-col">
        <!-- Main -->
        <div class="flex flex-auto flex-col px-6 py-10 sm:px-8 sm:pb-8 sm:pt-8">
            <!-- Email feed -->
            <div class="w-full max-w-3xl">
                <!-- Title -->
                <div class="text-3xl font-extrabold leading-none tracking-tight">Emails & Texts Sent</div>
                <div class="text-secondary mt-1.5 text-md">
                    Emails and texts sent to the patient are listed here as individual items, starting with the most
                    recent.
                </div>

                @if (data$ | async; as emails) {
                    @if (emails.length) {
                        <div class="mt-8">
                            <ol>
                                <!-- Emails -->
                                <ng-container>
                                    <ng-container>
                                        <li class="relative flex pb-2 pt-0">
                                            <div
                                                class="relative rounded-full px-8 py-2 text-md font-medium leading-5 text-on-primary"
                                                [class.bg-slate-400]="!isActiveThisMonth"
                                                [class.bg-primary]="isActiveThisMonth"
                                                (click)="showThisMonth()"
                                            >
                                                This Month
                                            </div>
                                            <div
                                                class="relative ml-2 rounded-full px-8 py-2 text-md font-medium leading-5 text-on-primary"
                                                [class.bg-slate-400]="!isActiveLastMonth"
                                                [class.bg-primary]="isActiveLastMonth"
                                                (click)="showLastMonth()"
                                            >
                                                Last Month
                                            </div>
                                            <div
                                                class="relative ml-2 rounded-full px-8 py-2 text-md font-medium leading-5 text-on-primary"
                                                [class.bg-slate-400]="!isActiveOlder"
                                                [class.bg-primary]="isActiveOlder"
                                                (click)="showOlder()"
                                            >
                                                Older
                                            </div>
                                        </li>
                                    </ng-container>
                                    <!-- Email -->
                                    @for (email of filterEmails; track trackByFn(i, email); let i = $index) {
                                        <li class="relative flex py-7">
                                            <!-- Line -->
                                            <ng-container>
                                                <div
                                                    class="absolute left-5 top-7 -ml-px h-full w-0.5 bg-gray-300 dark:bg-gray-600"
                                                ></div>
                                            </ng-container>
                                            <div
                                                class="relative flex flex-auto cursor-pointer"
                                                (click)="onSelectionChanged(email)"
                                            >
                                                <!-- Icon -->
                                                <div
                                                    class="mr-4 flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-gray-400"
                                                >
                                                    <mat-icon
                                                        class="text-white icon-size-5"
                                                        [svgIcon]="'heroicons_solid:mail-open'"
                                                    >
                                                    </mat-icon>
                                                </div>
                                                <!-- Content -->
                                                <div class="flex flex-auto flex-col items-start">
                                                    <!-- Contact Type -->
                                                    @if (email.contactType) {
                                                        <div [innerHTML]="email.contactType"></div>
                                                    }
                                                    <div
                                                        class="mt-2 flex flex-col text-md leading-5 sm:mt-1 sm:flex-row sm:items-center sm:space-x-2"
                                                    >
                                                        <!-- Date -->
                                                        <div class="text-secondary">
                                                            {{ email.addDate | datetimeformat }}
                                                        </div>
                                                    </div>
                                                    <!-- Note -->
                                                    @if (email.note) {
                                                        <div
                                                            class="mt-4 rounded-lg bg-gray-200 px-5 py-4 dark:bg-gray-800"
                                                            [innerHTML]="email.note"
                                                        ></div>
                                                    }
                                                </div>
                                            </div>
                                        </li>
                                    }
                                </ng-container>
                            </ol>
                        </div>
                    }
                    <!-- No Emails template -->
                    @if (!emails.length) {
                        <div class="py-8">
                            <div class="text-secondary mt-1.5 text-lg">There are no emails at the moment...</div>
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</div>
