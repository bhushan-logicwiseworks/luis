import{a as Ne}from"./chunk-XPFFTSXC.js";import{a as Se}from"./chunk-LQP35CM2.js";import{a as _e}from"./chunk-JBP6HANX.js";import{a as Ee}from"./chunk-Y5RI4PHI.js";import{Z as S,j as N}from"./chunk-4RIDPFY2.js";import{a as ve}from"./chunk-OD2F5SLA.js";import{a as ge,b as he,c as Ce}from"./chunk-6HRBECBJ.js";import{a as fe}from"./chunk-Z76PEBTC.js";import{c as z,d as G}from"./chunk-SIF5SKDU.js";import{a as re}from"./chunk-QZ2WTBPW.js";import{a as ye}from"./chunk-HIKYOSQ5.js";import{e as me}from"./chunk-YP5VDLTG.js";import{n as M}from"./chunk-7TJE7DO7.js";import{a as Ie}from"./chunk-UU7RD3EP.js";import{a as j}from"./chunk-WTDAEWCX.js";import{c as ce}from"./chunk-6WEMRU4N.js";import{a as Y,b as se,d as pe,h as de}from"./chunk-BV6IOHNV.js";import{B as L,D as $,c as oe,e as c,h as O,i as B,o as q,r as U,t as V,w as le}from"./chunk-4JDFQORI.js";import{a as ue}from"./chunk-TWDZ6JFE.js";import{a as ae,b as ne}from"./chunk-ETZ3F2L4.js";import{$b as d,Ab as D,Gb as u,Ia as T,Ic as g,Ja as x,Jc as h,Ob as a,Vb as C,Wb as A,Xb as E,Yb as _,Zb as l,_b as n,dc as F,fc as R,gc as y,hd as ee,id as te,jd as ie,mc as K,md as k,nc as W,oc as J,pb as i,rc as w,sc as m,tb as f,tc as P,uc as v,vc as Z}from"./chunk-3Q5CJMKA.js";import{b as X}from"./chunk-WFMAM73Y.js";import{a as b,b as H}from"./chunk-2AVGQ2MQ.js";function Fe(r,t){r&1&&(l(0,"mat-error",9),m(1,"Date Assigned cannot be in the past."),n())}function Re(r,t){r&1&&(l(0,"mat-error",9),m(1,"Due Date cannot be in the past."),n())}function we(r,t){if(r&1&&(l(0,"mat-option",12),m(1),n()),r&2){let e=t.$implicit;a("value",e.networkName),i(),P(e.networkName)}}function Pe(r,t){if(r&1&&(l(0,"mat-option",12),m(1),n()),r&2){let e=t.$implicit;a("value",e.networkName),i(),P(e.networkName)}}function ke(r,t){if(r&1){let e=F();l(0,"mat-checkbox",26),R("change",function(){let s=T(e).$implicit,p=y();return x(p.onLabelOptionChecked(s))}),m(1),n()}if(r&2){let e=t.$implicit;a("checked",e.selected),i(),v(" ",e.name," ")}}function Me(r,t){if(r&1){let e=F();l(0,"mat-checkbox",26),R("change",function(){let s=T(e).$implicit,p=y();return x(p.onBillingCodeChecked(s))}),m(1),n()}if(r&2){let e=t.$implicit;a("checked",e.selected),i(),v(" ",e.code," ")}}function Oe(r,t){if(r&1&&(l(0,"mat-option",20),m(1),n()),r&2){let e=t.$implicit;a("value",e),i(),v(" ",e," ")}}function Be(r,t){if(r&1&&(l(0,"mat-option",12),m(1),n()),r&2){let e=t.$implicit;a("value",e.networkName),i(),P(e.networkName)}}function qe(r,t){if(r&1&&(l(0,"div",29)(1,"mat-form-field",14)(2,"mat-label"),m(3,"Updated by User"),n(),l(4,"mat-select",30),E(5,Be,2,2,"mat-option",12,A),g(7,"async"),n()(),d(8,"ac-loading-overlay",13),g(9,"async"),n()),r&2){let e=y();i(),a("subscriptSizing","dynamic"),i(4),_(h(7,3,e.owners$)),i(3),a("diameter",50)("show",h(9,5,e.loadingOwners$))}}function Ue(r,t){if(r&1&&(l(0,"div",5)(1,"mat-form-field",21)(2,"mat-label"),m(3,"Shipment Date"),n(),d(4,"input",7)(5,"mat-datepicker-toggle",8)(6,"mat-datepicker",null,2),n()()),r&2){let e=w(7);i(),a("subscriptSizing","dynamic"),i(3),a("matDatepicker",e)("formControlName","shipmentDate"),i(),a("for",e)}}function Ve(r,t){r&1&&(l(0,"div",5)(1,"mat-form-field",21)(2,"mat-label"),m(3,"Contact Note"),n(),d(4,"textarea",31),n()()),r&2&&(i(),a("subscriptSizing","dynamic"),i(3),a("formControlName","contactNote"))}function Le(r,t){if(r&1&&(l(0,"fuse-alert",32),m(1),n()),r&2){let e=y();a("appearance","outline")("type",e.alert.type)("showIcon",!1)("@shake",!0),i(),v(" ",e.alert.message," ")}}var be=class Q{constructor(t,e,o,s,p){this.data=t,this.dialogRef=e,this.formBuilder=o,this.store=s,this.auxUtilService=p,this.alert=null,this.billingCodeOptions=[{code:"A4239",selected:!1},{code:"E2103",selected:!1},{code:"A9276",selected:!1},{code:"A9278",selected:!1}],this.billingDetailsOptions=["AUTH APPROVED","AUTH DENIED","AUTH SUBMITTED","AUTH NOT REQUIRED","PRISM IS OUT OF NETWORK","MISSING NOTES","DEDUCTIBLE IS NOT MET","PHARMACY ONLY BENEFIT","PATIENT DOES NOT QUALIFY FOR CGM","PCP REFERRAL SUBMITTED","PCP REFERRAL APPROVED","UNABLE TO OBTAIN PCP REFERRAL","CANCELLED BY FACILITY","CANCELLED BY PATIENT","MISSING INSURANCE","TITLEXIX","LIBRE ONLY"],this.owners$=this.store.select(S.selectOwners),this.loadingOwners$=this.store.select(S.selectOwnersLoading),this.payorRank1$=this.store.select(S.selectPayorRank1),this.labelOptions=[{name:"AUTH",selected:!1},{name:"VERIFY",selected:!1},{name:"NOTES",selected:!1}],this.showUpdatedByUser=!1,this.patientCareManagement=t.dynamicComponentData?.patientCareManagement,this.patientId=t.dynamicComponentData?.patientId,this.store.dispatch(N.LoadOwners()),this.patientId&&!this.patientCareManagement&&(this.store.dispatch(N.LoadPayorRank1({patientId:this.patientId})),this.payorRank1$.pipe(ne(this)).subscribe(I=>{I?.[0]?.billTo&&(this.careForm.patchValue({insuranceId:I[0].billTo}),this.careForm.get("insuranceId").disable())}))}ngOnInit(){if(this.careForm=this.formBuilder.group({dateAssigned:[""],dueDate:["",c.required],assignedTo:["",c.required],servicedBy:["",c.required],insuranceId:[{value:"",disabled:!0},c.required],insuranceUpdated:[!1,c.required],billingCode:["",c.required],billingDetails:["",c.required],sentForShipment:["N"],shipmentDate:["",""],contactNote:["",c.required],patientId:[this.patientId],createdBy:[{value:this.data?.dynamicComponentData?.addedBy,disabled:!0}],label:["",c.required],nobleId:[""],updatedByUser:[""]}),this.patientCareManagement){this.careForm.patchValue(H(b({},this.patientCareManagement),{shipmentDate:this.patientCareManagement.shipmentDate!=="1900-01-01T00:00:00"?this.patientCareManagement.shipmentDate:"",dueDate:this.patientCareManagement.dueDate!=="1900-01-01T00:00:00"?this.patientCareManagement.dueDate:""})),this.careForm.get("contactNote")?.clearValidators();let e=this.patientCareManagement.billingCode?.split(",")||[];this.billingCodeOptions.forEach(s=>{s.selected=e.includes(s.code)});let o=this.patientCareManagement.label?.split("/")||[];this.labelOptions.forEach(s=>{s.selected=o.includes(s.name)})}let t=this.careForm.get("billingDetails");t.valueChanges.subscribe(e=>{this.updateShowFlag(e)}),this.updateShowFlag(t.value)}ngAfterViewInit(){}ngOnDestroy(){}saveCareManagement(){if(this.careForm.invalid){this.alert={type:"error",message:"Please fill all required fields."},setTimeout(()=>this.alert=null,6e3);return}let t=b({},this.careForm.getRawValue());t=this.auxUtilService.transFormValuesToUpperCase(t,["assignedTo","servicedBy","billingCode","billingDetails","contactNote","createdBy","nobleId","updatedByUser"]),t=H(b({},t),{patientId:this.patientId,id:this.patientCareManagement?.id||0}),t.shipmentDate||(t.shipmentDate="1900-01-01T00:00:00"),t.dueDate||(t.dueDate="1900-01-01T00:00:00"),this.store.dispatch(N.AddPatientCareManagement({record:t})),this.dialogRef.close({success:!0})}closeDialog(){this.dialogRef.close()}onBillingCodeChecked(t){t.selected=!t.selected;let e=this.billingCodeOptions.filter(o=>o.selected).map(o=>o.code);this.careForm.get("billingCode").setValue(e.join(","))}onSentForShipmentChange(t){let e=this.careForm.get("shipmentDate"),o=this.careForm.get("sentForShipment");t.checked?o?.setValue("Y"):(o?.setValue("N"),e?.clearValidators(),e?.setValue(null)),e?.updateValueAndValidity()}onLabelOptionChecked(t){this.labelOptions.forEach(e=>e.selected=!1),t.selected=!0,this.careForm.get("label").setValue(t.name)}updateShowFlag(t){this.showUpdatedByUser=t==="AUTH APPROVED"||t==="AUTH DENIED"||t==="PCP REFERRAL APPROVED"||t==="UNABLE TO OBTAIN PCP REFERRAL"||t==="CANCELLED BY FACILITY"||t==="CANCELLED BY PATIENT"||t==="MISSING INSURANCE"||t==="TITLEXIX"||t==="LIBRE ONLY",this.showUpdatedByUser||this.careForm.get("updatedByUser").reset()}static{this.\u0275fac=function(e){return new(e||Q)(f(G),f(z),f(L),f(M),f(fe))}}static{this.\u0275cmp=D({type:Q,selectors:[["app-patient-caremanagement-add-request"]],decls:79,vars:45,consts:[["assignedPicker",""],["duePicker",""],["shipmentPicker",""],[1,"relative","flex","flex-auto","flex-col","items-center","px-6","sm:px-9"],[1,"w-full","max-w-3xl",3,"formGroup"],[1,"mt-4"],[1,"w-4/12","pr-2",3,"subscriptSizing"],["matInput","","required","",3,"matDatepicker","formControlName"],["matSuffix","",3,"for"],[1,"whitespace-nowrap"],[1,"w-6/12","pr-2",3,"subscriptSizing"],["formControlName","assignedTo"],[1,"uppercase",3,"value"],["type","spinner",3,"diameter","show"],[1,"w-6/12",3,"subscriptSizing"],["formControlName","servicedBy"],[1,"mt-2","flex","flex-wrap","gap-4"],["color","primary",3,"checked","change",4,"ngFor","ngForOf"],["matInput","","required","",1,"uppercase",3,"formControlName"],["required","",3,"formControlName"],[3,"value"],[1,"w-full",3,"subscriptSizing"],["matInput","","readonly","","required","",1,"uppercase",3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["class","mt-4 flex items-center",4,"ngIf"],["matInput","",1,"uppercase",3,"formControlName"],["color","primary",3,"change","checked"],["class","mt-4",4,"ngIf"],["class","mt-4",3,"appearance","type","showIcon",4,"ngIf"],[1,"mt-4","flex","items-center"],["formControlName","updatedByUser"],["matInput","","rows","2",1,"uppercase",3,"formControlName"],[1,"mt-4",3,"appearance","type","showIcon"]],template:function(e,o){if(e&1){let s=F();l(0,"div",3)(1,"form",4)(2,"div",5)(3,"mat-form-field",6)(4,"mat-label"),m(5,"Date Assigned"),n(),d(6,"input",7)(7,"mat-datepicker-toggle",8)(8,"mat-datepicker",null,0),u(10,Fe,2,0,"mat-error",9),n(),l(11,"mat-form-field",6)(12,"mat-label"),m(13,"Due Date"),n(),d(14,"input",7)(15,"mat-datepicker-toggle",8)(16,"mat-datepicker",null,1),u(18,Re,2,0,"mat-error",9),n()(),l(19,"div",5)(20,"mat-form-field",10)(21,"mat-label"),m(22,"Assigned To"),n(),l(23,"mat-select",11),E(24,we,2,2,"mat-option",12,A),g(26,"async"),n()(),d(27,"ac-loading-overlay",13),g(28,"async"),l(29,"mat-form-field",14)(30,"mat-label"),m(31,"Serviced By"),n(),l(32,"mat-select",15),E(33,Pe,2,2,"mat-option",12,A),g(35,"async"),n()(),d(36,"ac-loading-overlay",13),g(37,"async"),n(),l(38,"div",5)(39,"div",16),u(40,ke,2,2,"mat-checkbox",17),n()(),l(41,"div",5)(42,"mat-form-field",10)(43,"mat-label"),m(44,"Insurance ID"),n(),d(45,"input",18),n(),l(46,"mat-form-field",14)(47,"mat-label"),m(48,"Insurance Updated"),n(),l(49,"mat-select",19)(50,"mat-option",20),m(51,"Yes"),n(),l(52,"mat-option",20),m(53,"No"),n()()()(),l(54,"div",5)(55,"mat-label"),m(56,"Billing Code"),n(),l(57,"div",16),u(58,Me,2,2,"mat-checkbox",17),n(),l(59,"mat-form-field",21),d(60,"input",22),n()(),l(61,"div",5)(62,"mat-form-field",21)(63,"mat-label"),m(64,"Billing Details"),n(),l(65,"mat-select",19),u(66,Oe,2,2,"mat-option",23),n()()(),u(67,qe,10,7,"div",24),l(68,"div",5)(69,"mat-form-field",21)(70,"mat-label"),m(71,"Noble ID"),n(),d(72,"input",25),n()(),l(73,"div",5)(74,"mat-checkbox",26),R("change",function(I){return T(s),x(o.onSentForShipmentChange(I))}),m(75," Sent for Shipment "),n()(),u(76,Ue,8,4,"div",27)(77,Ve,5,2,"div",27)(78,Le,2,5,"fuse-alert",28),n()()}if(e&2){let s=w(9),p=w(17);i(),a("formGroup",o.careForm),i(2),a("subscriptSizing","dynamic"),i(3),a("matDatepicker",s)("formControlName","dateAssigned"),i(),a("for",s),i(3),C(o.careForm.get("dateAssigned").hasError("pastDate")?10:-1),i(),a("subscriptSizing","dynamic"),i(3),a("matDatepicker",p)("formControlName","dueDate"),i(),a("for",p),i(3),C(o.careForm.get("dueDate").hasError("pastDate")?18:-1),i(2),a("subscriptSizing","dynamic"),i(4),_(h(26,37,o.owners$)),i(3),a("diameter",50)("show",h(28,39,o.loadingOwners$)),i(2),a("subscriptSizing","dynamic"),i(4),_(h(35,41,o.owners$)),i(3),a("diameter",50)("show",h(37,43,o.loadingOwners$)),i(4),a("ngForOf",o.labelOptions),i(2),a("subscriptSizing","dynamic"),i(3),a("formControlName","insuranceId"),i(),a("subscriptSizing","dynamic"),i(3),a("formControlName","insuranceUpdated"),i(),a("value",!0),i(2),a("value",!1),i(6),a("ngForOf",o.billingCodeOptions),i(),a("subscriptSizing","dynamic"),i(),a("formControlName","billingCode"),i(2),a("subscriptSizing","dynamic"),i(3),a("formControlName","billingDetails"),i(),a("ngForOf",o.billingDetailsOptions),i(),a("ngIf",o.showUpdatedByUser),i(2),a("subscriptSizing","dynamic"),i(3),a("formControlName","nobleId"),i(2),a("checked",o.careForm.get("sentForShipment").value==="Y"),i(2),a("ngIf",o.careForm.get("sentForShipment").value==="Y"),i(),a("ngIf",!o.patientCareManagement),i(),a("ngIf",o.alert)}},dependencies:[$,q,oe,O,B,le,U,V,de,Y,ce,he,Ce,pe,ge,se,ye,me,re,te,Ie,ie,j,k],encapsulation:2,data:{animation:ue}})}};be=X([ae()],be);var $e=["quillEditor"],Ye=(r,t)=>t.id;function ze(r,t){if(r&1&&(l(0,"div",11)(1,"span",12),m(2),g(3,"datetimeformat"),n(),d(4,"app-aux-html-content-renderer",13),n(),d(5,"mat-divider",14)),r&2){let e=t.$implicit;a("ngClass",e.priority==="PRIORITY"?"text-red-500":"text-black dark:text-white"),i(2),Z(" ADDED ON ",h(3,4,e.addDate)," BY ",e.addUserId," "),i(2),a("htmlContent",e.note.toUpperCase())}}function Ge(r,t){r&1&&(l(0,"div",10),m(1,"NO NOTES FOUND"),n())}function je(r,t){if(r&1&&(E(0,ze,6,6,null,null,Ye),u(2,Ge,2,0,"div",10)),r&2){let e=t;_(e),i(2),C(e.length?-1:2)}}function He(r,t){if(r&1&&(l(0,"fuse-alert",9),m(1),n()),r&2){let e=y();a("appearance","outline")("type",e.alert.type)("showIcon",!1)("@shake",!0),i(),v(" ",e.alert.message," ")}}var St=(()=>{class r{constructor(e,o,s,p){this.formBuilder=e,this.store=o,this.dialogRef=s,this.data=p,this.alert=null,this.quillModules={toolbar:!1},this.contactNotes$=this.store.select(S.selectContactNotes)}ngOnInit(){this.initForm()}initForm(){let e=this.data||{},o=e.patientId||0,s=e.refId||0,p=e.moduleName||"CAREMANAGEMENT",I="CAREMANAGEMENT";this.contactForm=this.formBuilder.group({contactType:[I,c.required],note:["",c.required],priority:[!1],entityID:[o,c.required],refId:[s],moduleName:[p]})}saveContactNote(){if(!this.contactForm){console.error("Form is not initialized"),this.alert={type:"error",message:"Form initialization failed. Please try again."},setTimeout(()=>{this.alert=null},6e3);return}let e=this.contactForm.value,s=this.quillEditor.quillEditor.getText().trim(),p={id:0,entityType:"PATIENT",entityID:e.entityID,contactType:e.contactType,note:s.toUpperCase(),addUserId:"SYSTEM",addDate:new Date().toISOString(),message:"",priority:e.priority?"PRIORITY":"",refId:e.refId};this.isInputValid(p)&&(this.store.dispatch(N.AddContactNote({note:p})),this.dialogRef.close())}isInputValid(e){return e.contactType?!e.note||e.note.trim()===""||e.note==="<p><br></p>"||e.note==="<H1><BR></H1>"?(this.alert={type:"error",message:"Note cannot be blank."},setTimeout(()=>{this.alert=null},6e3),!1):e.entityID?!0:(this.alert={type:"error",message:"entity ID cannot be blank."},setTimeout(()=>{this.alert=null},6e3),!1):(this.alert={type:"error",message:"Contact Type cannot be blank."},setTimeout(()=>{this.alert=null},6e3),!1)}closeDialog(){this.dialogRef.close()}static{this.\u0275fac=function(o){return new(o||r)(f(L),f(M),f(z),f(G))}}static{this.\u0275cmp=D({type:r,selectors:[["app-patient-caremanagement-notes"]],viewQuery:function(o,s){if(o&1&&K($e,5),o&2){let p;W(p=J())&&(s.quillEditor=p.first)}},decls:14,vars:8,consts:[["quillEditor",""],[1,"flex","h-full","flex-col"],[1,"flex-1","overflow-y-auto"],[1,"h-full"],[3,"formGroup"],[1,"mt-8","bg-white","p-4","shadow-inner","dark:bg-gray-900"],[1,"text-black","dark:text-white"],[1,"text-red"],[1,"mt-2","w-full","uppercase",3,"formControlName","placeholder","modules"],[1,"mt-4",3,"appearance","type","showIcon"],[1,"p-4","text-center","text-gray-500"],[1,"flex","flex-col","p-4",3,"ngClass"],[1,"text-secondary","text-sm"],[3,"htmlContent"],[1,"w-full"]],template:function(o,s){if(o&1&&(l(0,"div",1)(1,"div",2)(2,"ac-scrollbar",3),u(3,je,3,1),g(4,"async"),n()(),l(5,"form",4)(6,"div",5)(7,"mat-label",6),m(8,"Notes"),n(),l(9,"mat-label",7),m(10,"*"),n(),d(11,"quill-editor",8,0),n(),u(13,He,2,5,"fuse-alert",9),n()()),o&2){let p;i(3),C((p=h(4,6,s.contactNotes$))?3:-1,p),i(2),a("formGroup",s.contactForm),i(6),a("formControlName","note")("placeholder","Notes")("modules",s.quillModules),i(2),C(s.alert?13:-1)}},dependencies:[Se,ee,Ne,ve,$,q,O,B,U,V,Y,_e,j,k,Ee],encapsulation:2})}}return r})();export{be as a,St as b};
