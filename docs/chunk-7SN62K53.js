import{$ as Qo,$a as W,A as To,Aa as pn,B as Mo,Ba as bt,C as Do,Ca as St,D as ko,Da as un,E as $o,Ea as fn,F as Eo,Fa as Ee,G as Lo,Ga as li,H as jo,Ha as hn,I as Bo,Ia as Fn,J as No,Ja as _n,K as Oo,Ka as P,L as Ro,La as q,M as Po,Ma as ze,N as zo,Na as R,O as Uo,Oa as vn,P as Ho,Pa as Cn,Q as Go,Qa as gn,R as Ko,Ra as xn,S as Yo,Sa as ll,T as J,Ta as yn,U as Zo,Ua as An,V as qo,Va as wn,W as vt,Wa as bn,X as Xt,Xa as sl,Y as Wo,Ya as Sn,Z as Jo,Za as Vn,_ as ei,_a as Le,a as ht,aa as ae,ab as al,b as Ft,ba as ti,bb as Tn,c as rl,ca as Xo,cb as cl,d as go,da as ii,db as dl,e as zt,ea as Ct,eb as ml,f as Ut,fa as en,fb as pl,g as ke,ga as gt,gb as ul,h as Ht,ha as oi,hb as fl,i as xo,ia as xt,j as yo,ja as tn,k as Pe,ka as ni,l as Gt,la as on,lb as hl,m as Ao,ma as $e,n as wo,na as nn,nb as Vt,o as Kt,oa as rn,ob as It,p as Yt,pa as ln,pb as ve,q as Zt,qa as te,qb as zn,r as bo,ra as yt,rb as Un,s as qt,sa as ri,sb as Hn,t as Wt,ta as sn,tb as Gn,u as So,ua as an,ub as Kn,v as _t,va as At,vb as Tt,w as Jt,wa as cn,wb as Fl,x as Qt,xa as dn,xb as Yn,y as Vo,ya as wt,z as Io,za as mn}from"./chunk-CYV2MHKG.js";import{a as Mn,b as Dn,c as kn,d as $n,e as En,f as Ln,g as jn,h as Bn,i as Nn,j as On,k as Rn,l as Pn}from"./chunk-ZWQIBEUI.js";import{a as In}from"./chunk-VZ64S7CE.js";import{a as vo,b as Co}from"./chunk-3NH6NOP6.js";import{a as ho,b as Fo,c as _o}from"./chunk-ZCEPZISC.js";import{a as ol,b as nl}from"./chunk-3N6FPJZU.js";import{a as uo,b as fo}from"./chunk-JST4RBVZ.js";import"./chunk-HHBLH35P.js";import"./chunk-YO73HNCF.js";import{a as po}from"./chunk-X74UJ3QR.js";import{a as lo}from"./chunk-VGE2PNKJ.js";import{a as ro,b as so}from"./chunk-7O4GN6JJ.js";import{a as De}from"./chunk-RW26HZBH.js";import"./chunk-Y5RI4PHI.js";import{a as ao,b as co,c as mo}from"./chunk-BLZL7MQY.js";import{a as ut}from"./chunk-OD2F5SLA.js";import"./chunk-WX54DYK2.js";import"./chunk-6HRBECBJ.js";import"./chunk-E6UI7ODH.js";import{a as no}from"./chunk-V2BYYYUY.js";import"./chunk-ODTVUJKH.js";import"./chunk-Z76PEBTC.js";import"./chunk-GLNCR2H3.js";import{a as Pt,b as se}from"./chunk-M7CNBRZG.js";import"./chunk-2LVKS4R7.js";import{a as to}from"./chunk-BWPVOFCI.js";import{a as re,b as le}from"./chunk-T6JQBFCO.js";import{c as at,d as ct,e as pe}from"./chunk-SIF5SKDU.js";import"./chunk-F5X5MWHG.js";import"./chunk-3IAIBVAD.js";import{a as lt}from"./chunk-QZ2WTBPW.js";import{c as pt}from"./chunk-KFQHPBEM.js";import{a as Rt}from"./chunk-7RWCIHFI.js";import"./chunk-HIKYOSQ5.js";import"./chunk-7LGNX6B7.js";import{a as oo}from"./chunk-XU6AK5HV.js";import"./chunk-YP5VDLTG.js";import"./chunk-PCFNTMO3.js";import"./chunk-QG7HLPG5.js";import{a as v,b as _e,c as C,e as io}from"./chunk-W6W3L4PS.js";import{c as ft}from"./chunk-ZKDLRTZU.js";import"./chunk-FADVVZG5.js";import{n as O,q as Yi}from"./chunk-7TJE7DO7.js";import"./chunk-UCIJYWKW.js";import{a as il}from"./chunk-2SL7SW2K.js";import{f as Me}from"./chunk-MYHJKLLN.js";import"./chunk-6WEMRU4N.js";import"./chunk-S6VYPJGT.js";import"./chunk-I3M6OUQD.js";import"./chunk-BV6IOHNV.js";import{D as Xi,c as qi,h as Wi,m as Ji,q as Qi}from"./chunk-4JDFQORI.js";import"./chunk-EPIW33CJ.js";import{l as eo,o as dt,q as mt}from"./chunk-YUJOUWZJ.js";import"./chunk-S2ZXS5BT.js";import"./chunk-TWDZ6JFE.js";import"./chunk-M4WH542H.js";import"./chunk-CF7SUKG7.js";import{a as Fe,b as ee}from"./chunk-ETZ3F2L4.js";import"./chunk-3QHLU7SJ.js";import{J as st,p as Zi}from"./chunk-HJKZPT2B.js";import{b as he,d as me}from"./chunk-W5GYUEPJ.js";import{$b as w,$c as zi,Ab as U,B as Oe,Bb as Nt,Bc as Oi,Cb as Li,Cc as Ri,Db as ji,Dc as ot,G,Gb as k,H as Xe,Ia as $,Ic as K,J as D,Ja as E,Jc as Z,Kc as Pi,Mc as nt,N as et,Ob as f,Qb as tt,Sc as rt,Ta as Di,Ua as ki,Ub as Ot,Vb as L,Wb as it,Xb as ge,Ya as $i,Yb as xe,Zb as a,_b as m,ac as ye,bc as Ae,da as Ti,dc as N,fc as V,g as Ii,gc as h,ha as A,hc as Bi,hd as Ui,ic as Ni,kb as Ei,kd as Hi,la as Y,ld as Gi,ma as z,md as ne,ob as Bt,od as Ki,p as b,pb as d,qa as oe,ra as jt,rc as Ie,sc as I,ta as Mi,tb as g,tc as de,uc as Te,v as y,w as Ce,wa as M,x as ie,xa as Re}from"./chunk-3Q5CJMKA.js";import{b as fe}from"./chunk-WFMAM73Y.js";import{a as H,b as ue,e as Lt,g as _}from"./chunk-2AVGQ2MQ.js";var Sr=Lt((ci,di)=>{(function(t,o){typeof ci=="object"&&typeof di<"u"?di.exports=o():typeof define=="function"&&define.amd?define(o):(t=typeof globalThis<"u"?globalThis:t||self).filesize=o()})(ci,function(){"use strict";var t=/^(b|B)$/,o={iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},e={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]},i={floor:Math.floor,ceil:Math.ceil};function n(l){var c,T,x,p,r,s,u,F,j,X,Ve,Ze,qe,Et,Be,We,gi,Je,xi,yi,Ne,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},S=[],Qe=0;if(isNaN(l))throw new TypeError("Invalid number");if(x=B.bits===!0,Be=B.unix===!0,Ze=B.pad===!0,T=B.base||10,qe=B.round!==void 0?B.round:Be?1:2,u=B.locale!==void 0?B.locale:"",F=B.localeOptions||{},We=B.separator!==void 0?B.separator:"",gi=B.spacer!==void 0?B.spacer:Be?"":" ",xi=B.symbols||{},Je=T===2?B.standard||"iec":"jedec",Ve=B.output||"string",r=B.fullform===!0,s=B.fullforms instanceof Array?B.fullforms:[],c=B.exponent!==void 0?B.exponent:-1,yi=i[B.roundingMethod]||Math.round,j=(X=Number(l))<0,p=T>2?1e3:1024,Ne=isNaN(B.precision)===!1?parseInt(B.precision,10):0,j&&(X=-X),(c===-1||isNaN(c))&&(c=Math.floor(Math.log(X)/Math.log(p)))<0&&(c=0),c>8&&(Ne>0&&(Ne+=8-c),c=8),Ve==="exponent")return c;if(X===0)S[0]=0,Et=S[1]=Be?"":o[Je][x?"bits":"bytes"][c];else{Qe=X/(T===2?Math.pow(2,10*c):Math.pow(1e3,c)),x&&(Qe*=8)>=p&&c<8&&(Qe/=p,c++);var Ai=Math.pow(10,c>0?qe:0);S[0]=yi(Qe*Ai)/Ai,S[0]===p&&c<8&&B.exponent===void 0&&(S[0]=1,c++),Et=S[1]=T===10&&c===1?x?"kbit":"kB":o[Je][x?"bits":"bytes"][c],Be&&(S[1]=S[1].charAt(0),t.test(S[1])&&(S[0]=Math.floor(S[0]),S[1]=""))}if(j&&(S[0]=-S[0]),Ne>0&&(S[0]=S[0].toPrecision(Ne)),S[1]=xi[S[1]]||S[1],u===!0?S[0]=S[0].toLocaleString():u.length>0?S[0]=S[0].toLocaleString(u,F):We.length>0&&(S[0]=S[0].toString().replace(".",We)),Ze&&Number.isInteger(S[0])===!1&&qe>0){var wi=We||".",bi=S[0].toString().split(wi),Si=bi[1]||"",Vi=Si.length,tl=qe-Vi;S[0]="".concat(bi[0]).concat(wi).concat(Si.padEnd(Vi+tl,"0"))}return r&&(S[1]=s[c]?s[c]:e[Je][c]+(x?"bit":"byte")+(S[0]===1?"":"s")),Ve==="array"?S:Ve==="object"?{value:S[0],symbol:S[1],exponent:c,unit:Et}:S.join(gi)}return n.partial=function(l){return function(c){return n(c,l)}},n})});var Or=Lt(fi=>{var ls={width:24,height:24,body:'<path fill="currentColor" d="M4.47 19h15.06L12 5.99L4.47 19zM13 18h-2v-2h2v2zm0-4h-2v-4h2v4z" opacity=".3"/><path fill="currentColor" d="M1 21h22L12 2L1 21zm3.47-2L12 5.99L19.53 19H4.47zM11 16h2v2h-2zm0-6h2v4h-2z"/>'};fi.__esModule=!0;fi.default=ls});var Wr=Lt(_i=>{var ms={width:24,height:24,body:'<path fill="currentColor" d="M8 7h11v14H8z" opacity=".3"/><path fill="currentColor" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>'};_i.__esModule=!0;_i.default=ms});var jr=_(ht()),Br=_(ol()),Nr=_(nl());var Ke=_(rl());var qn=_(vn()),Wn=_(Cn()),Jn=_(Pt()),Qn=_(gn()),Xn=_(xn()),er=_(ll()),tr=_(yn()),ir=_(An()),or=_(ht()),nr=_(wn()),rr=_(bn()),lr=_(sl()),sr=_(Sn()),ar=_(Vn());var Zn=(()=>{class t{constructor(){}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=U({type:t,selectors:[["ac-action-button"]],inputs:{icon:"icon"},decls:2,vars:3,consts:[["matRipple","","matRippleColor","rgba(250,250,250,.2)",1,"flex","cursor-pointer","items-center","justify-center","rounded-full","px-3","py-1","hover:shadow-xl",2,"width","42px"],["color","#2563eb","size","24px",1,"font-light","text-white",3,"icon","inline"]],template:function(i,n){i&1&&(a(0,"div",0),w(1,"ic-icon",1),m()),i&2&&(f("@fadeInUp",void 0),d(),f("icon",n.icon)("inline",!0))},dependencies:[eo,le,re],encapsulation:2,data:{animation:[De]}})}}return t})();var _l=t=>({viewMode:t});function vl(t,o){if(t&1){let e=N();a(0,"ac-action-button",5),V("click",function(){$(e);let n=h(2);return E(n.downloadFile())}),m()}if(t&2){let e=h(2);f("icon",e.icCloudDownload)("matTooltip","Download File")}}function Cl(t,o){if(t&1){let e=N();a(0,"ac-action-button",5),V("click",function(){$(e);let n=h(2);return E(n.generateLink())}),m()}if(t&2){let e=h(2);f("icon",e.icLink)("matTooltip","Link")}}function gl(t,o){if(t&1){let e=N();a(0,"ac-action-button",5),V("click",function(){$(e);let n=h(2);return E(n.deleteFile())}),m()}if(t&2){let e=h(2);f("icon",e.icTrash)("matTooltip","Delete")}}function xl(t,o){if(t&1){let e=N();a(0,"div",1)(1,"div",2)(2,"div",3),k(3,vl,1,2,"ac-action-button",4),a(4,"ac-action-button",5),V("click",function(){$(e);let n=h();return E(n.renameVault())}),m(),k(5,Cl,1,2,"ac-action-button",4)(6,gl,1,2,"ac-action-button",4),m(),a(7,"div",6),w(8,"mat-divider",7)(9,"span",8),K(10,"async"),m()()()}if(t&2){let e=h(),i=Ie(2);d(3),L(e.fileActions.selection.selected.length&&e.fileIsSelected()?3:-1),d(),f("icon",e.icPencil)("matTooltip","Rename vault"),d(),L(e.fileActions.selection.selected.length===1?5:-1),d(),L(e.fileActions.selection.selected.length&&e.allowDelete()?6:-1),d(2),f("vertical",!0),d(),f("ngTemplateOutlet",i)("ngTemplateOutletContext",ot(10,_l,Z(10,8,e.viewMode$)))}}function yl(t,o){if(t&1){let e=N();a(0,"ac-action-button",9),V("click",function(){let n=$(e).viewMode,l=h();return E(l.setViewMode(n))}),m()}if(t&2){let e=o.viewMode,i=h();f("icon",e==="list"?i.icGallery:i.icList)}}var Mt=class si{constructor(o,e,i,n){this.store=o,this.fileActions=e,this.dialog=i,this._fuseConfirmationService=n,this.icAdd=tr.default,this.icRefresh=sr.default,this.icCloudDownload=Wn.default,this.icTrash=Jn.default,this.icEye=Qn.default,this.icList=Xn.default,this.icGallery=qn.default,this.icCloudCircle=ar.default,this.icFolder=or.default,this.icFile=nr.default,this.icLink=rr.default,this.icCopyAll=ir.default,this.icMoreVert=lr.default,this.icPencil=er.default,this.isAdmin=!1,this.viewMode$=this.store.select(R.selectViewMode),this.selectedFile$=this.store.select(R.selectSelectedFile),this.displayFn$=this.store.select(ft.selectIsAdmin),this.selectedVault$=this.store.select(P.selectCurrentVault),this.files$=this.store.select(R.selectFilesInFolder),this.folderChildren$=this.store.select(q.selectChildren),this.selectedFileFolderMap={}}ngOnInit(){this.displayFn$.pipe(ee(this)).subscribe(o=>{o==!0?this.isAdmin=!0:this.isAdmin=!1}),this.selectedVault$.pipe(ee(this)).subscribe(o=>{this.vaultData=o}),Ce([this.files$,this.folderChildren$]).pipe(ee(this)).subscribe(([o,e])=>{e&&(this.selectedFileFolderMap=H(H({},this.selectedFileFolderMap),Me(e,"folderId"))),o&&(this.selectedFileFolderMap=H(H({},this.selectedFileFolderMap),Me(o,"fileId")))})}setViewMode(o){this.store.dispatch(Zo({viewMode:o==="list"?"gallery":"list"}))}downloadFile(){let o=[];this.fileActions.selection.selected.forEach(i=>{o.push(this.selectedFileFolderMap[i])}),this.store.dispatch(ke({files:o}))}fileIsSelected(){return this.fileActions.selection.selected.every(o=>this.selectedFileFolderMap[o]?.hasOwnProperty("fileName"))}allowDelete(){return this.fileActions.selection.selected.every(e=>this.selectedFileFolderMap[e]?.hasOwnProperty("fileName"))?!0:this.fileActions.selection.selected.every(i=>!this.selectedFileFolderMap[i]?.hasOwnProperty("fileName"))}isSelected(){return this.fileActions.selection.selected.every(o=>o.hasOwnProperty("fileName")&&!o.hasOwnProperty("fileName"))}deleteFile(){let o=[];this.fileActions.selection.selected.forEach(l=>{o.push(this.selectedFileFolderMap[l])});let i=o.filter(l=>l.displayName),n=o.filter(l=>!l.displayName);i.length?this.store.dispatch(_t({file:i})):this.store.dispatch(gt({folder:n}))}generateLink(){let o=this.fileActions.selection.selected[0];this.store.dispatch(bt({resourceType:this.selectedFileFolderMap[o].fileId?"file":"folder",resource:this.selectedFileFolderMap[o]}))}copySelection(){}renameVault(){this.dialog.open(se,{width:"30vw",height:"auto",data:{icon:"mat_outline:edit_note",title:"Edit Vault",cancelButtonText:"Cancel",saveButtonText:"Save",dynamicComponent:Le,dynamicComponentData:{vault:this.vaultData,toCreate:"Vault",isEdit:!0},submitFunction:"edit",enterKeyEnabled:!1,deleteFunction:"delete"},autoFocus:!1}).afterClosed().pipe(G(o=>!!o)).subscribe(o=>{if(!o.del)return this.store.dispatch(At(o));this._fuseConfirmationService.open({title:"Confirm Delete",message:"Do you really want to delete <b>"+this.vaultData.vaultName+"</b> and all of its files and folders?",actions:{confirm:{label:"Yes, delete it!"},cancel:{label:"Cancel"}}}).afterClosed().pipe(G(e=>e=="confirmed")).subscribe(e=>{this.fileActions.selection.clear(),this.store.dispatch(wt({id:o.id}))})})}moveSelection(){}static{this.\u0275fac=function(e){return new(e||si)(g(O),g(W),g(pe),g(to))}}static{this.\u0275cmp=U({type:si,selectors:[["ac-vault-center-action-bar"]],decls:3,vars:1,consts:[["viewModeToggle",""],["id","file-action-bar",1,"flex","w-full","items-center","justify-between","px-8","py-4"],[1,"flex","w-full","flex-1","items-center","justify-between"],[1,"left","flex","items-center"],[3,"icon","matTooltip"],[3,"click","icon","matTooltip"],[1,"right","flex","items-center"],[1,"mx-2",2,"height","30px","border-right-color","blue",3,"vertical"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"click","icon"]],template:function(e,i){e&1&&k(0,xl,11,12,"div",1)(1,yl,1,1,"ng-template",null,0,nt),e&2&&L(i.vaultData?0:-1)},dependencies:[Zn,pt,ut,Gi,ne],styles:["[_nghost-%COMP%]{width:100%}button.mat-flat-button.mat-primary[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.tree-scroller[_ngcontent-%COMP%]{flex:1 1 auto}  .mdc-button__label{display:flex;align-items:center}"],data:{animation:[In,De]}})}};Mt=fe([Fe()],Mt);var cr=_(al()),dr=_(Tn());function Al(t,o){t&1&&(a(0,"span",3),I(1," > "),m())}function wl(t,o){if(t&1){let e=N();a(0,"div",1)(1,"div",2),V("click",function(){let n=$(e).$implicit,l=h();return E(l.setCurrentFolder(n))}),I(2),K(3,"async"),m(),k(4,Al,2,0,"span",3),m()}if(t&2){let e,i=o.$implicit,n=o.$index,l=o.$count,c=h();d(),tt("dark:text-gray-400",n!==l-1)("text-blue-300",n===l-1),d(),Te(" ",i.folderName.toString().indexOf("Root")===0?(e=Z(3,6,c.selectedVault$))==null?null:e.vaultName:i.folderName," "),d(2),L(n!==l-1?4:-1)}}var mr=(()=>{class t{constructor(e,i){this.store=e,this.fileActionService=i,this.icChevronRight=cr.default,this.icFolderOpen=dr.default,this.breadcrumbs$=this.store.select(ze.selectBreadcrumbsArray).pipe(y(n=>n||[])),this.selectedVault$=this.store.select(P.selectCurrentVault)}ngOnInit(){}setCurrentFolder(e){this.fileActionService.selection.clear(),this.store.dispatch(ae({folder:e})),this.store.dispatch(J({file:null,skipNavigation:!0}))}static{this.\u0275fac=function(i){return new(i||t)(g(O),g(W))}}static{this.\u0275cmp=U({type:t,selectors:[["ac-file-list-breadcrumbs"]],decls:4,vars:2,consts:[[1,"flex","flex-auto","select-none","overflow-hidden","px-6","pb-4","pt-5"],[1,"relative","flex"],[1,"item-center","flex","cursor-pointer","text-lg","text-black","hover:text-blue-500",3,"click"],[1,"mx-2","text-gray-400"]],template:function(i,n){i&1&&(a(0,"div",0),ge(1,wl,5,8,"div",1,it),K(3,"async"),m()),i&2&&(d(),xe(Z(3,0,n.breadcrumbs$)))},dependencies:[ne],encapsulation:2})}}return t})();var Mr=_(cl()),Dr=_(dl()),kr=_(ml()),$r=_(pl()),Er=_(Tn()),Lr=_(ul());var pr=_(vn()),ur=_(Cn()),fr=_(Pt()),hr=_(gn()),Fr=_(xn()),_r=_(yn()),vr=_(fl()),Cr=_(An()),gr=_(wn()),xr=_(bn()),yr=_(Sn()),Ar=_(Vn());function bl(t,o){if(t&1){let e=N();a(0,"button",2),V("click",function(){$(e);let n=h();return E(n.downloadFile())}),w(1,"ic-icon",3),a(2,"span"),I(3,"Download"),m()()}if(t&2){let e=h();d(),f("icon",e.icCloudDownload)("inline",!0)}}function Sl(t,o){if(t&1){let e=N();a(0,"button",2),V("click",function(){$(e);let n=h();return E(n.fileActions.previewFile())}),w(1,"ic-icon",3),a(2,"span"),I(3,"Preview"),m()()}if(t&2){let e=h();d(),f("icon",e.icEye)("inline",!0)}}var Dt=class ai{constructor(o,e){this.store=o,this.fileActions=e,this.icAdd=_r.default,this.icRefresh=yr.default,this.icCloudDownload=ur.default,this.icTrash=fr.default,this.icEye=hr.default,this.icList=Fr.default,this.icGallery=pr.default,this.icCloudCircle=Ar.default,this.icFile=gr.default,this.icLink=xr.default,this.icCopyAll=Cr.default,this.icEdit=vr.default,this.isAdmin=!1,this.displayFn$=this.store.select(ft.selectIsAdmin)}ngOnInit(){this.displayFn$.pipe(ee(this)).subscribe(o=>{o==!0?this.isAdmin=!0:this.isAdmin=!1})}downloadFile(){this.store.dispatch(ke({files:[this.fileActions.el]})),this.fileActions.closeMenu()}static{this.\u0275fac=function(e){return new(e||ai)(g(O),g(W))}}static{this.\u0275cmp=U({type:ai,selectors:[["ac-file-actions-menu"]],decls:17,vars:9,consts:[[1,"rounded","border-gray-800","bg-white","py-2","shadow-xl",2,"min-width","250px"],["mat-menu-item","",1,"hover:text-blue-500"],["mat-menu-item","",1,"hover:text-blue-500",3,"click"],["size","18px",1,"mr-4",3,"icon","inline"],["mat-menu-item","",1,"text-red-500",3,"click"]],template:function(e,i){e&1&&(a(0,"div",0),k(1,bl,4,2,"button",1)(2,Sl,4,2,"button",1),w(3,"mat-divider"),a(4,"button",2),V("click",function(){return i.fileActions.generateLink()}),w(5,"ic-icon",3),a(6,"span"),I(7,"Create direct link"),m()(),a(8,"button",2),V("click",function(){return i.fileActions.rename()}),w(9,"ic-icon",3),a(10,"span"),I(11,"Rename"),m()(),w(12,"mat-divider"),a(13,"button",4),V("click",function(){return i.fileActions.deleteFile()}),w(14,"ic-icon",3),a(15,"span"),I(16,"Remove"),m()()()),e&2&&(f("@scaleInOut",void 0),d(),L(i.fileActions.type==="file"?1:-1),d(),L(i.fileActions.type==="file"?2:-1),d(3),f("icon",i.icLink)("inline",!0),d(4),f("icon",i.icEdit)("inline",!0),d(5),f("icon",i.icTrash)("inline",!0))},dependencies:[oo,le,re,ut],styles:["[_nghost-%COMP%]     .mdc-list-item__primary-text{display:flex;align-items:center}"],data:{animation:[Ft]}})}};Dt=fe([Fe()],Dt);var wr=_(ht());var Vl=["*"],Il=t=>({"active rounded-2xl":t}),Tl=()=>({color:"#e8bb4d"});function Ml(t,o){t&1&&w(0,"mat-icon",6),t&2&&f("svgIcon","folder")("ngStyle",Ri(2,Tl))}function Dl(t,o){t&1&&(a(0,"div",7),w(1,"mat-icon",10),a(2,"div",11),I(3," PDF "),m()()),t&2&&(d(),f("svgIcon","heroicons_solid:document"))}var br=(()=>{class t{constructor(e,i){this.store=e,this.fileActions=i,this.icFolder=wr.default,this.isFileSelected=!1,this.selectedFile$=this.store.select(R.selectSelectedFile)}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)(g(O),g(W))}}static{this.\u0275cmp=U({type:t,selectors:[["ac-gallery-view-item"]],inputs:{item:"item",isFileSelected:"isFileSelected"},ngContentSelectors:Vl,decls:14,vars:10,consts:[[1,"p-6"],[1,"-m-2","flex","flex-wrap"],[1,"bg-card","relative","m-2","h-40","w-40","rounded-2xl","p-4","shadow"],[1,"absolute","inset-0","z-10","flex","cursor-pointer","flex-col","p-4",3,"ngClass","matTooltip","matTooltipDisabled"],[1,"aspect-[9/6]"],[1,"flex","h-full","items-center","justify-center"],[1,"icon-size-24",3,"svgIcon","ngStyle"],[1,"relative"],[1,"flex","flex-auto","flex-col","justify-center","text-center","text-sm","font-medium"],[1,"text-secondary","truncate"],[1,"text-hint","icon-size-14",3,"svgIcon"],[1,"absolute","bottom-0","left-0","rounded","bg-red-600","px-1.5","text-sm","font-semibold","leading-5","text-white"]],template:function(i,n){if(i&1&&(Bi(),a(0,"div",0)(1,"div",1)(2,"div",2),Ni(3),a(4,"a",3),K(5,"async"),a(6,"div",4)(7,"div",5),k(8,Ml,1,3,"mat-icon",6)(9,Dl,4,1,"div",7),m()(),a(10,"div",8),ye(11),a(12,"div",9),I(13),m(),Ae(),m()()()()()),i&2){let l;d(4),f("ngClass",ot(8,Il,((l=Z(5,6,n.selectedFile$))==null?null:l.fileId)===n.item.fileId&&!n.fileActions.selection.selected.length&&n.isFileSelected))("matTooltip",n.item.displayName||n.item.folderName)("matTooltipDisabled",((n.item.displayName||n.item.folderName)==null?null:(n.item.displayName||n.item.folderName).length)<20),d(4),L(n.item.displayName?-1:8),d(),L(n.item.displayName?9:-1),d(4),de(n.item.displayName||n.item.folderName)}},dependencies:[Ui,pt,st,Hi,ne],styles:[".gallery-item[_ngcontent-%COMP%]:not(.active):hover{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1));--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.active[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(191 219 254 / var(--tw-bg-opacity, 1));transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}@media only screen and (max-width: 600px){.responsive[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px;line-height:8px}}@media only screen and (min-width: 600px) and (max-width: 800px){.responsive[_ngcontent-%COMP%]{width:21.3333333333px;height:21.3333333333px;font-size:21.3333333333px;line-height:10.6666666667px}}@media only screen and (min-width: 800px) and (max-width: 1500px){.responsive[_ngcontent-%COMP%]{width:32px;height:32px;font-size:32px;line-height:16px}}@media only screen and (min-width: 1500px) and (max-width: 1800px){.responsive[_ngcontent-%COMP%]{width:42.6666666667px;height:42.6666666667px;font-size:42.6666666667px;line-height:21.3333333333px}}@media only screen and (min-width: 1800px){.responsive[_ngcontent-%COMP%]{width:64px!important;height:64px!important;font-size:64px;line-height:32px}}"]})}}return t})();var Vr=_(Sr(),1),Ir=(()=>{class t{static transformOne(e,i){return(0,Vr.default)(e,i)}transform(e,i){return Array.isArray(e)?e.map(n=>t.transformOne(n,i)):t.transformOne(e,i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=ji({name:"filesize",type:t,pure:!0,standalone:!1}),t})(),Tr=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Nt({type:t}),t.\u0275inj=jt({}),t})();function $l(t,o){if(t&1&&(a(0,"div",15),w(1,"ic-icon",16),a(2,"span",17),I(3,"No files found"),m()()),t&2){let e=h(2);d(),f("icon",e.icCloudNone)("inline",!0)}}function El(t,o){t&1&&w(0,"mat-header-cell")}function Ll(t,o){t&1&&w(0,"img",18)}function jl(t,o){if(t&1&&w(0,"ic-icon",19),t&2){let e=h(3);f("icon",e.icFolder)("inline",!0)}}function Bl(t,o){if(t&1&&(a(0,"mat-cell"),k(1,Ll,1,0,"img",18)(2,jl,1,2,"ic-icon",19),m()),t&2){let e=o.$implicit;d(),L(e.displayName?1:-1),d(),L(e.displayName?-1:2)}}function Nl(t,o){t&1&&(a(0,"mat-header-cell",20),I(1," Name"),m())}function Ol(t,o){if(t&1&&(a(0,"span",22),I(1),K(2,"contentType"),m()),t&2){let e=h().$implicit;d(),de(Z(2,1,e.contentType))}}function Rl(t,o){if(t&1&&(a(0,"mat-cell")(1,"div",21)(2,"span"),I(3),m(),k(4,Ol,3,3,"span",22),m()()),t&2){let e=o.$implicit;d(3),de(e.displayName||e.folderName),d(),L(e.displayName?4:-1)}}function Pl(t,o){t&1&&(a(0,"mat-header-cell",20),I(1," size"),m())}function zl(t,o){if(t&1&&(a(0,"span"),I(1),K(2,"filesize"),m()),t&2){let e=h().$implicit;d(),de(Z(2,1,e.contentSize))}}function Ul(t,o){if(t&1&&(a(0,"mat-cell"),k(1,zl,3,3,"span"),m()),t&2){let e=o.$implicit;d(),L(e.displayName?1:-1)}}function Hl(t,o){t&1&&(a(0,"mat-header-cell",20),I(1," Modified"),m())}function Gl(t,o){if(t&1&&(a(0,"span"),I(1),K(2,"date"),m()),t&2){let e=h().$implicit;d(),Te(" ",Pi(2,1,e.modifiedDate,"short"),"")}}function Kl(t,o){if(t&1&&(a(0,"mat-cell"),k(1,Gl,3,4,"span"),m()),t&2){let e=o.$implicit;d(),L(e.displayName?1:-1)}}function Yl(t,o){t&1&&w(0,"mat-header-row")}function Zl(t,o){if(t&1){let e=N();a(0,"mat-row",23),K(1,"async"),V("click",function(){let n=$(e).$implicit,l=h(2);return E(l.selectFile(n))})("contextmenu",function(n){let l=$(e).$implicit;return h(2).onMenu(n,l,l.displayName?"file":"folder"),E(n.preventDefault())}),m()}if(t&2){let e,i=o.$implicit,n=h(2);tt("active",((e=Z(1,2,n.selectedFile$))==null?null:e.fileId)===i.fileId)}}function ql(t,o){if(t&1&&(a(0,"mat-table",3),k(1,$l,4,2,"ng-template",5),ye(2,6),k(3,El,1,0,"mat-header-cell",7)(4,Bl,3,2,"mat-cell",8),Ae(),ye(5,9),k(6,Nl,2,0,"mat-header-cell",10)(7,Rl,5,2,"mat-cell",8),Ae(),ye(8,11),k(9,Pl,2,0,"mat-header-cell",10)(10,Ul,2,1,"mat-cell",8),Ae(),ye(11,12),k(12,Hl,2,0,"mat-header-cell",10)(13,Kl,2,1,"mat-cell",8),Ae(),k(14,Yl,1,0,"mat-header-row",13)(15,Zl,2,4,"mat-row",14),m()),t&2){let e=h();f("dataSource",e.dataSource),d(14),f("matHeaderRowDef",e.displayedColumns),d(),f("matRowDefColumns",e.displayedColumns)}}function Wl(t,o){if(t&1){let e=N();a(0,"ic-icon",30),V("click",function(n){$(e);let l=h().$implicit,c=h(2);return E(c.setSelectedFile(n,l))}),m()}if(t&2){let e=h(3);f("icon",e.icAddCircle)("inline",!0)}}function Jl(t,o){if(t&1){let e=N();a(0,"ic-icon",31),V("click",function(n){$(e);let l=h().$implicit,c=h(2);return E(c.setUnselectedFile(n,l))}),m()}if(t&2){let e=h(3);f("icon",e.icCheck)("inline",!0)}}function Ql(t,o){if(t&1){let e=N();a(0,"ac-gallery-view-item",26),V("contextmenu",function(n){let l=$(e).$implicit;return h(2).onMenu(n,l,l.displayName?"file":"folder"),E(n.preventDefault())})("click",function(){let n=$(e).$implicit,l=h(2);return E(l.selectFile(n))}),a(1,"div",27),k(2,Wl,1,2,"ic-icon",28)(3,Jl,1,2,"ic-icon",29),m()()}if(t&2){let e=o.$implicit,i=h(2);f("item",e)("isFileSelected",i.fileSelected),d(2),L(i.fileActionsMenuService.selection.isSelected(e.fileId||e.folderId)?-1:2),d(),L(i.fileActionsMenuService.selection.isSelected(e.fileId||e.folderId)?3:-1)}}function Xl(t,o){if(t&1&&(a(0,"div",15),w(1,"ic-icon",32),a(2,"span",17),I(3,"No Folders found"),m()()),t&2){let e=h(2);d(),f("icon",e.icCloudNone)("inline",!0)}}function es(t,o){if(t&1&&(a(0,"div")(1,"div",24),ge(2,Ql,4,4,"ac-gallery-view-item",25,Ot().trackByFn,!0),m(),k(4,Xl,4,2,"div",15),m()),t&2){let e=h();d(2),xe(e.dataSource.filteredData),d(2),L(!(e.dataSource==null||e.dataSource.data==null)&&e.dataSource.data.length?-1:4)}}function ts(t,o){if(t&1){let e=N();a(0,"ic-icon",30),V("click",function(n){$(e);let l=h().$implicit,c=h(2);return E(c.setSelectedFile(n,l))}),m()}if(t&2){let e=h(3);f("icon",e.icAddCircle)("inline",!0)}}function is(t,o){if(t&1){let e=N();a(0,"ic-icon",31),V("click",function(n){$(e);let l=h().$implicit,c=h(2);return E(c.setUnselectedFile(n,l))}),m()}if(t&2){let e=h(3);f("icon",e.icCheck)("inline",!0)}}function os(t,o){if(t&1){let e=N();a(0,"ac-gallery-view-item",26),V("contextmenu",function(n){let l=$(e).$implicit;return h(2).onMenu(n,l,l.displayName?"file":"folder"),E(n.preventDefault())})("click",function(){let n=$(e).$implicit,l=h(2);return E(l.selectFile(n))}),a(1,"div",27),k(2,ts,1,2,"ic-icon",28)(3,is,1,2,"ic-icon",29),m()()}if(t&2){let e=o.$implicit,i=h(2);f("item",e)("isFileSelected",i.fileSelected),d(2),L(i.fileActionsMenuService.selection.isSelected(e.fileId||e.folderId)?-1:2),d(),L(i.fileActionsMenuService.selection.isSelected(e.fileId||e.folderId)?3:-1)}}function ns(t,o){if(t&1&&(a(0,"div",15),w(1,"ic-icon",32),a(2,"span",17),I(3,"No Folders found"),m()()),t&2){let e=h(2);d(),f("icon",e.icCloudNone)("inline",!0)}}function rs(t,o){if(t&1&&(a(0,"div")(1,"div",24),ge(2,os,4,4,"ac-gallery-view-item",25,Ot().trackByFn,!0),m(),k(4,ns,4,2,"div",15),m()),t&2){let e=h();d(2),xe(e.dataSource.filteredData),d(2),L(!(e.dataSource==null||e.dataSource.data==null)&&e.dataSource.data.length?-1:4)}}var kt=class mi{constructor(o,e,i,n,l,c,T){this.store=o,this.cd=e,this.fileActionsMenuService=i,this.route=n,this.dragService=l,this.dialog=c,this.router=T,this.icFolder=Er.default,this.icQueryStats=Lr.default,this.icCloudNone=kr.default,this.icControl=$r.default,this.files$=this.store.select(R.selectFilesInFolder),this.currentFolder$=this.store.select(q.selectCurrentFolder),this.selectedFile$=this.store.select(R.selectSelectedFile),this.loading$=this.store.select(R.selectLoading),this.viewMode$=this.store.select(R.selectViewMode),this.folderChildren$=this.store.select(q.selectChildren),this.selectFolders$=this.store.select(q.selectEntities),this.allFiles$=this.store.select(R.selectEntities),this.folders$=this.store.select(q.selectAll),this.dataSource=new Pn,this.displayedColumns=["logo","displayName","contentSize","modifiedDate"],this.pageSize=20,this.pageSizeOptions=[5,10,20,50],this.icAddCircle=Mr.default,this.icCheck=Dr.default,this.fileSelected=!1,this.selectedFileFolderMap={}}ngOnInit(){Ce([this.route.queryParamMap,this.selectFolders$,this.folders$,this.route.params]).pipe(ee(this)).subscribe(([o,e,i,n])=>{let l=n.vaultId,c=o.get("folderId"),T=o.get("fileId");if(!e||!Object.keys(e).length)return;let x=new URLSearchParams(window.location.search),p=x.get("folderId"),r=x.get("fileId"),s=!this.paramFolderId||p!==c||this.paramVaultId!==l,u=!this.paramFileId||r!==T;this.paramVaultId=l,this.paramFolderId=c,this.paramFileId=T;let F=o.has("folderId")?e[c]:null,j=F&&F.vaultId===Number(l)||!1;if((!F||!j)&&(F=this.findRootFolder(i,l)),o.has("folderId")&&F){if(o.has("fileId")&&u){this.store.dispatch(ae({folder:F,withFile:Number(T)}));return}(s||!j)&&this.store.dispatch(ae({folder:F}))}if(l&&!o.has("folderId")){let X=this.findRootFolder(i,l);X&&this.store.dispatch(ae({folder:X}))}}),this.fileActionsMenuService.search.subscribe(o=>{o=o?.trim(),o=o?.toLowerCase(),this.dataSource.filter=o||"",this.cd.markForCheck()}),Ce([this.files$,this.folderChildren$]).pipe(ee(this)).subscribe(([o,e])=>{let i=[];e&&(this.selectedFileFolderMap=H(H({},this.selectedFileFolderMap),Me(e,"folderId")),i.push(...e)),o&&(i.push(...o),this.selectedFileFolderMap=H(H({},this.selectedFileFolderMap),Me(o,"fileId"))),this.dataSource.data=i,this.cd.detectChanges()})}findRootFolder(o,e){return o.find(i=>i.vaultId===Number(e)&&i.folderParentId===null)}setSelectedFile(o,e){o.stopImmediatePropagation(),o.preventDefault(),this.fileActionsMenuService.selection.select(e.fileId||e.folderId),e.displayName&&this.store.dispatch(J({file:e}))}setUnselectedFile(o,e){o.stopImmediatePropagation(),o.preventDefault(),this.fileActionsMenuService.selection.deselect(e.fileId||e.folderId),e.displayName&&(this.store.dispatch(J({file:null})),this.fileActionsMenuService.selection.selected&&this.fileActionsMenuService.selection.selected.forEach(i=>{this.selectedFileFolderMap[i].displayName&&this.store.dispatch(J({file:this.selectedFileFolderMap[i]}))}))}selectFile(o){if(this.fileActionsMenuService.selection.clear(),!o.displayName)return this.store.dispatch(J({file:null})),this.store.dispatch(ae({folder:o}));this.fileSelected=!0,this.store.dispatch(J({file:o}));let e={icon:"mat_outline:assignment",iconColor:"primary",title:"VIEW FILE DETAIL",titleColor:"text-secondary",cancelButtonText:"Cancel",saveButtonText:"Save",dynamicComponent:zn,dynamicComponentData:!1,submitFunction:"saveData",enterKeyEnabled:!0};this.dialog.open(se,{width:"550px",maxWidth:"100%",panelClass:["animate__animated","animate__slideInRight","animated","ac-commcenter-dialog","m0-dialog","custom-container"],position:{top:"0px",right:"0px"},height:"100vh",data:e}).afterClosed().pipe(ee(this)).subscribe(i=>{this.fileSelected=!1})}ngAfterViewInit(){}ngOnDestroy(){this.store.dispatch(qo()),this.store.dispatch(on())}trackByFn(o){return o.fileId||o.folderId}onMenu(o,e,i){this.fileActionsMenuService.open(o,e,i,Dt)}startDrag(o){this.dragService.startDragging(o)}stopDrag(){this.dragService.stopDragging()}static{this.\u0275fac=function(e){return new(e||mi)(g(O),g(rt),g(W),g(he),g(Hn),g(pe),g(me))}}static{this.\u0275cmp=U({type:mi,selectors:[["ac-vault-center-file-list"]],features:[Oi([])],decls:9,vars:6,consts:[["gallery",""],[1,"vault-center-list","flex","h-full","flex-auto","flex-col","overflow-auto"],[1,"relative","mt-0"],["matSort","","id","vault-center-table",1,"shadow-none",3,"dataSource"],[3,"show"],["cdkNoDataRow",""],["matColumnDef","logo"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","displayName"],["mat-sort-header","","class","uppercase",4,"matHeaderCellDef"],["matColumnDef","contentSize"],["matColumnDef","modifiedDate"],[4,"matHeaderRowDef"],[3,"active","click","contextmenu",4,"matRowDef","matRowDefColumns"],[1,"flex","w-full","flex-col","items-center","justify-center","py-6","text-gray-400"],["color","#4299e1","size","48px",3,"icon","inline"],[1,"mt-5"],["src","fileTypeIcons/file-pdf-box.svg","height","18px","width","18px",2,"width","18px !important","height","18px !important","max-width","unset"],["color","#e8bb4d","size","24px",3,"icon","inline"],["mat-sort-header","",1,"uppercase"],[1,"flex","items-center"],[1,"ml-3","self-end","text-xs","uppercase","text-gray-400"],[3,"click","contextmenu"],[1,"flex","flex-wrap"],[1,"gallery-items","h-full","min-w-8",3,"item","isFileSelected"],[1,"gallery-items","h-full","min-w-8",3,"contextmenu","click","item","isFileSelected"],[1,"absolute","right-0","top-0","z-40","px-1","py-1"],["color","gray","size","18px",1,"cursor-pointer",3,"icon","inline"],["color","#2f855a","size","18px",1,"cursor-pointer",3,"icon","inline"],["color","gray","size","18px",1,"cursor-pointer",3,"click","icon","inline"],["color","#2f855a","size","18px",1,"cursor-pointer",3,"click","icon","inline"],["color","#2f855a","size","48px",3,"icon","inline"]],template:function(e,i){e&1&&(a(0,"div",1)(1,"div",2),k(2,ql,16,3,"mat-table",3),K(3,"async"),k(4,es,5,1,"div"),w(5,"ac-loading-overlay",4),K(6,"async"),m()(),k(7,rs,5,1,"ng-template",null,0,nt)),e&2&&(d(2),L(Z(3,2,i.viewMode$)==="list"?2:4),d(3),f("show",Z(6,4,i.loading$)))},dependencies:[Dn,vo,Mn,le,re,En,$n,Ln,kn,jn,Co,Bn,On,Nn,Rn,br,lt,ne,Ki,Tr,Ir,Un],encapsulation:2,changeDetection:0})}};kt=fe([Fe()],kt);var Ye=class pi{constructor(o,e,i,n,l,c,T){this.store=o,this.route=e,this.breakpointObserver=i,this.router=n,this.fileActions=l,this.cdr=c,this.serchService=T,this.icMenu=Br.default,this.drawerMode="side",this.drawerOpened=!0,this.isHandset$=this.breakpointObserver.observe([Rt.Tablet,Rt.Handset]).pipe(y(x=>x.matches),Ti()),this.icFolder=jr.default,this.icSearch=Nr.default,this.selectedVaultId=-1,this.selectedFile$=this.store.select(R.selectSelectedFile),this.allVaults=[],this.searchCtrl=new Ji,this.toggleMenu=!1,this.menuData$=new Ii([{title:"Actions",subtitle:"Add Patient",type:"group",children:[{title:"Add Vault",type:"basic",icon:"mat_outline:account_balance",function:()=>{this.addVault()}},{title:"Add Folder",type:"basic",icon:"mat_outline:create_new_folder",function:()=>{this.addFolder()}},{title:"Add File",type:"basic",icon:"mat_outline:file_upload",function:()=>{this.addFile()}}]},{title:"Vaults",type:"group",children:[]}]),this.vaults$=this.store.select(P.selectAll)}ngOnInit(){this.searchCtrl.valueChanges.pipe(ee(this)).subscribe(o=>this.serchService.search.next(o)),this.vaults$.pipe(ee(this)).subscribe(o=>{let e=!!(this.selectedVaultId&&this.selectedVaultId!==-1),i=o.map(l=>({title:l.vaultName,type:"basic",icon:"heroicons_outline:folder",active:e?Number(l.vaultId)===this.selectedVaultId:!1,function:()=>{this.fileActions.selection.clear(),this.store.dispatch(te({id:l.vaultId})),this.router.navigateByUrl(`/centers/vault-center/${l.vaultId}`)}})),n=this.menuData$.getValue();n[1]=ue(H({},n[1]),{children:(0,Ke.cloneDeep)(i)}),this.allVaults=o,this.menuData$.next((0,Ke.cloneDeep)(n))}),Ce([this.menuData$,this.store.select(P.selectSelectedVaultId)]).pipe(ee(this),G(([o])=>o[1].children.length>0)).subscribe(([o,e])=>{e!==this.selectedVaultId&&this.selectVault(e)})}selectVault(o){this.selectedVaultId=o;let e=this.allVaults.findIndex(i=>Number(i.vaultId)===this.selectedVaultId);if(e>-1){let i=this.menuData$.getValue(),n=i[1].children.map((l,c)=>ue(H({},l),{active:c===e}));i[1]=ue(H({},i[1]),{children:(0,Ke.cloneDeep)(n)}),this.menuData$.next((0,Ke.cloneDeep)(i)),this.cdr.detectChanges()}}changeFile(o){this.store.dispatch(Pe({files:o}))}ngOnDestroy(){}checkStore(o){return this.store.select(P.selectLoaded).pipe(Y(e=>{e||this.store.dispatch($e())}),A(e=>{if(Number(o.vaultId))return this.store.dispatch(te({id:Number(o.vaultId)})),this.selectVault(Number(o.vaultId)),b(e)}),G(e=>!!e),et(1))}addVault(){this.store.dispatch(yt())}addFolder(){this.store.dispatch(vt())}addFile(){this.store.dispatch(Pe({files:[]}))}static{this.\u0275fac=function(e){return new(e||pi)(g(O),g(he),g(Zi),g(me),g(W),g(rt),g(W))}}static{this.\u0275cmp=U({type:pi,selectors:[["ac-vault-center"]],decls:26,vars:10,consts:[["matDrawer",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-card","flex","flex-0","flex-col","border-b","p-6","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:py-6"],[1,"min-w-0","flex-1"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],[1,"min-w-0"],[1,"mt-2"],[1,"flex","flex-none","items-center","bg-white","px-4","dark:bg-transparent"],[1,"bg-base","flex","w-full","flex-1","items-center","rounded-full","border","px-5","py-4"],[1,"mr-2","icon-size-5",3,"svgIcon"],["placeholder","Search Results...","type","text",1,"placeholder-black","w-full","bg-transparent","outline-none",3,"formControl"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"h-full","flex-auto"],[1,"w-72","dark:bg-gray-900",3,"autoFocus","mode","opened"],[3,"menuData","showTitle"],[1,"flex","flex-col"],[1,"flex-auto"],[1,"z-50","flex-shrink-0"],[1,"flex-shrink-0"],[1,""],[3,"emitFileChange"]],template:function(e,i){if(e&1){let n=N();a(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"h2",4),I(5," VaultCenter "),m()()(),a(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8),w(10,"mat-icon",9)(11,"input",10),m()()()(),a(12,"div",11)(13,"button",12),V("click",function(){$(n);let c=Ie(17);return E(c.toggle())}),w(14,"mat-icon",13),m()()(),a(15,"mat-drawer-container",14)(16,"mat-drawer",15,0),w(18,"aux-sidebar",16),K(19,"async"),m(),a(20,"mat-drawer-content",17)(21,"div",18),w(22,"ac-vault-center-action-bar",19)(23,"ac-file-list-breadcrumbs",20)(24,"ac-vault-center-file-list",21),m()()()(),a(25,"ac-full-screen-dropzone",22),V("emitFileChange",function(c){return $(n),E(i.changeFile(c))}),m()}e&2&&(d(10),f("svgIcon","mat_outline:search"),d(),f("formControl",i.searchCtrl),d(3),f("svgIcon","heroicons_outline:menu"),d(2),f("autoFocus",!1)("mode",i.drawerMode)("opened",i.drawerOpened),d(2),f("menuData",Z(19,8,i.menuData$))("showTitle",!1))},dependencies:[st,Xi,qi,Wi,Qi,dt,mo,co,po,ao,Mt,mr,kt,Kn,ne],styles:["h1[_ngcontent-%COMP%]{font-size:12px;font-weight:600;letter-spacing:.05em;text-transform:uppercase;--tw-text-opacity: 1;color:rgba(var(--fuse-primary-600-rgb),var(--tw-text-opacity));opacity:1}"],data:{animation:[De,so,ro,Ft,lo]}})}};Ye=fe([Fe()],Ye);var ui=(()=>{class t{constructor(e,i){this.store=e,this.route=i}canActivate(e){return this.checkStore(e).pipe(A(()=>b(!0)),D(()=>b(!1)))}checkStore(e){return this.store.select(P.selectLoaded).pipe(Y(i=>{i||this.store.dispatch($e())}),A(i=>Number(e.params.vaultId)?(this.store.dispatch(te({id:Number(e.params.vaultId)})),b(i)):(this.store.dispatch(nn()),b(!0))),G(i=>!!i),et(1))}static{this.\u0275fac=function(i){return new(i||t)(M(O),M(he))}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Rr=_(Or());var $t=(()=>{class t{constructor(e,i){this.data=e,this.ref=i,this.icWarning=Rr.default,this.selectedData=e}ngOnInit(){}confirmDelete(){console.log("confirm delete",this.selectedData.dynamicComponentData.obj),this.ref.close(this.selectedData?.dynamicComponentData.obj)}static{this.\u0275fac=function(i){return new(i||t)(g(ct),g(at))}}static{this.\u0275cmp=U({type:t,selectors:[["ac-confirm"]],decls:3,vars:2,consts:[[1,"flex","w-full","flex-col","items-center","justify-center","p-10"],["size","48px",1,"flex-none","rounded-full","bg-white","p-1","text-yellow-600",3,"icon"],[1,"mt-10",3,"innerHTML"]],template:function(i,n){i&1&&(a(0,"div",0),w(1,"ic-icon",1)(2,"span",2),m()),i&2&&(d(),f("icon",n.icWarning),d(),f("innerHTML",n.data==null?null:n.data.message,Ei))},dependencies:[le,re],encapsulation:2})}}return t})();var Pr=_(Pt()),zr=_(Fl()),Ur=_(ht()),Hr=_(hl());var Gr=_(il());function ss(t,o){t&1&&(a(0,"div",6),I(1,"No files selected"),m())}function as(t,o){if(t&1){let e=N();a(0,"mat-list-item",8)(1,"div",14),w(2,"img",15),a(3,"div",16)(4,"span"),I(5),m(),a(6,"span")(7,"button",17),V("click",function(){let n=$(e).$index,l=h();return E(l.deleteFile(n))}),w(8,"ic-icon",18),m()()()()()}if(t&2){let e=o.$implicit,i=h();d(5),de(e.displayName),d(3),f("icon",i.icTrash)}}var Kr=(()=>{class t{constructor(e,i,n){this.data=e,this.ref=i,this.store=n,this.icOutlineLibraryAdd=zr.default,this.icTrash=Pr.default,this.icSave=Hr.default,this.icFolder=Ur.default,this.loading$=this.store.select(R.selectLoading)}ngOnInit(){}deleteFile(e){this.data.files.splice(e,1)}addFilesClicked(e){Xe(...Array.from(e.target.files).map(i=>Gn(i))).subscribe(i=>{this.data.files=this.data.files.concat(...i)})}uploadFiles(){if(this.data.folder&&this.data.folder?.folderId){let e=this.data.files.map(i=>ue(H({},i),{folderId:this.data.folder?.folderId}));this.ref.close(e)}else Gr.default.fire({position:"top-end",icon:"warning",title:"Oops...",text:"You have to select vault or folder first to add file...",showConfirmButton:!1,timer:3e3}),this.ref.close()}static{this.\u0275fac=function(i){return new(i||t)(g(ct),g(at),g(O))}}static{this.\u0275cmp=U({type:t,selectors:[["ac-file-upload"]],decls:19,vars:10,consts:[["filepicker",""],[1,"mat-dialog-title","flex","w-full","items-center"],[1,"flex","w-full","justify-end"],[1,"flex","items-center","rounded-full","bg-primary","px-4","py-2","text-white"],["size","18px",1,"mr-2",3,"inline","icon"],[1,"mat-dialog-content","my-4","flex","flex-wrap"],[1,"flex","w-full","justify-center","p-3","text-sm","text-gray-500"],[1,"w-full"],[1,"mb-2","w-full"],[1,"mt-6","w-full"],["hidden","true","type","file","onclick","this.value=null","accept",".pdf",3,"change","multiple"],["mat-button","","color","primary",1,"w-full",3,"click"],["size","18px",1,"mr-2",3,"icon","inline"],[3,"show"],[1,"flex","items-center"],["mat-list-avatar","","src","fileTypeIcons/file-pdf-box.svg","height","40","width","40",1,"mr-4",2,"width","40px","height","40px"],[1,"flex","w-full","items-center","justify-between"],["mat-icon-button","","color","warn",1,"flex","items-center","justify-center",3,"click"],["size","18px",3,"icon"]],template:function(i,n){if(i&1){let l=N();a(0,"div",1)(1,"div",2)(2,"span",3),w(3,"ic-icon",4),I(4),m()()(),a(5,"div",5),k(6,ss,2,0,"div",6),a(7,"mat-list",7),ge(8,as,9,2,"mat-list-item",8,it),m(),a(10,"div",9)(11,"input",10,0),V("change",function(T){return $(l),E(n.addFilesClicked(T))}),m(),a(13,"button",11),V("click",function(){$(l);let T=Ie(12);return E(T.click())}),w(14,"ic-icon",12),a(15,"span"),I(16,"Add Files"),m()()()(),w(17,"ac-loading-overlay",13),K(18,"async")}i&2&&(d(3),f("inline",!0)("icon",n.icFolder),d(),Te(" ",n.data.folder==null?null:n.data.folder.folderName,""),d(2),L(n.data.files!=null&&n.data.files.length?-1:6),d(2),xe(n.data.files),d(3),f("multiple",!0),d(3),f("icon",n.icOutlineLibraryAdd)("inline",!0),d(3),f("show",Z(18,8,n.loading$)))},dependencies:[le,re,uo,fo,dt,mt,lt,ne],encapsulation:2})}}return t})();var Yr=(()=>{class t{constructor(e,i,n,l,c,T,x,p){this.actions$=e,this.store=i,this.vaultApiService=n,this.dialog=l,this.sheet=c,this.fileActions=T,this.router=x,this.activatedRoute=p,this.upsertFiles$=v(()=>this.actions$.pipe(C(ae),Y(()=>this.store.dispatch(Kt())),z(this.store.select(R.selectFilesInFolder)),A(([{folder:r,withFile:s},u])=>this.vaultApiService.getFiles(r?.folderId).pipe(y(F=>Yt({files:F})),D(F=>(console.log(F),b(Zt({error:F})))))))),this.upsertChangesFiles$=v(()=>this.actions$.pipe(C(ni),Y(()=>this.store.dispatch(Kt())),A(({file:r})=>this.vaultApiService.getFiles(r.folderId).pipe(ie(s=>{let u=[Yt({files:s})];return s.find(j=>j.fileId===r.fileId)||u.push(Qt({ids:[r.fileId]})),u}),D(s=>(console.log(s),b(Zt({error:s})))))))),this.initAddFiles$=v(()=>this.actions$.pipe(C(Pe),z(this.store.select(q.selectCurrentFolder)),A(([{files:r},s])=>this.dialog.open(se,{width:"40vw",height:"auto",data:{icon:"mat_outline:edit_note",title:"Upload Files",cancelButtonText:"Cancel",saveButtonText:"Upload",dynamicComponent:Kr,dynamicComponentData:{files:r,folder:s},submitFunction:"uploadFiles",enterKeyEnabled:!1},autoFocus:!1}).afterClosed()),G(r=>!!r),y(r=>Gt({files:r})))),this.addFiles=v(()=>this.actions$.pipe(C(Gt),A(({files:r})=>Xe(...r.map(s=>this.vaultApiService.addFile(s))).pipe(y(s=>Ao({allFiles:s})),D(s=>b(wo({error:s}))))))),this.initUpdateFile$=v(()=>this.actions$.pipe(C(bo),A(({file:r})=>this.sheet.open(It,{data:{element:r,type:"file"}}).afterDismissed()),G(r=>!!r),y(r=>qt({file:r,updateStatus:null})))),this.updateFile$=v(()=>this.actions$.pipe(C(qt),z(this.store.select(q.selectCurrentFolder)),ie(([{file:r,updateStatus:s},u])=>{if(r.fileBlob){let F=r.fileBlob;delete r.fileBlob}return this.vaultApiService.addFile(r).pipe(ie(F=>{let j=[Wt({file:{id:r.fileId,changes:F},updateStatus:s})];return s&&j.push(ni({file:F})),j}),D(F=>b(So({error:F}))),Y(()=>{no.CUSTOM_SUCCESS("fileSaveSuccess")}))}))),this.loadTags$=v(()=>this.actions$.pipe(C(Mo),A(({fileId:r})=>this.vaultApiService.getTags(r).pipe(Y(s=>console.log(s,"")),y(s=>Do({tags:s,fileId:r})),D(s=>b(ko({error:s}))))))),this.addTag$=v(()=>this.actions$.pipe(C($o),A(({tag:r})=>this.vaultApiService.addTag(r).pipe(Y(s=>console.log(s)),y(s=>Eo({tag:s})),D(s=>(console.log(s),b(Lo({error:s})))))))),this.deleteTag$=v(()=>this.actions$.pipe(C(jo),A(({tag:r})=>this.vaultApiService.deleteTag(r).pipe(y(()=>Bo()),D(s=>b(No({error:s}))))))),this.loadNotifications$=v(()=>this.actions$.pipe(C(Oo),A(({fileId:r})=>this.vaultApiService.getNotifications(r).pipe(y(s=>Ro({notification:s[0],fileId:r})),D(s=>b(Po({error:s}))))))),this.addNotification$=v(()=>this.actions$.pipe(C(zo),A(({notification:r})=>this.vaultApiService.addNotification(r).pipe(y(s=>Uo({notification:s})),D(s=>b(Ho({error:s}))))))),this.deleteNotification$=v(()=>this.actions$.pipe(C(Go),A(({notification:r})=>this.vaultApiService.deleteNotification(r).pipe(y(()=>Ko()),D(s=>b(Yo({error:s}))))))),this.updateFileSuccess$=v(()=>this.actions$.pipe(C(Wt),z(this.store.select(P.selectSelectedVaultId)),y(([r,s])=>{if(r.updateStatus){let u=new URLSearchParams(this.activatedRoute.snapshot.queryParams);u.delete("fileId");let F=u.toString().length?"?"+u:"",j=`${window.location.origin}/centers/vault-center/${s}${F}`;history.pushState(null,null,j)}return J({file:r.file.changes})}))),this.previewFile$=v(()=>this.actions$.pipe(C(go),z(this.store.select(R.selectSelectedFile)),A(([{file:r},s])=>this.vaultApiService.getFile(r.fileId||s.fileId).pipe(y(u=>zt({file:u[0]})),D(u=>b(Ut({error:u}))))))),this.previewFileSuccess$=v(()=>this.actions$.pipe(C(zt),Y(({file:r})=>{let s=Tt(r.fileBlob,"application/pdf"),u=URL.createObjectURL(s);window?.open(u,"_blank")})),{dispatch:!1}),this.getFileURL$=v(()=>this.actions$.pipe(C(Io),A(({id:r})=>this.vaultApiService.getFile(r).pipe(y(s=>{let u=Tt(s[0].fileBlob,"application/pdf");return URL.createObjectURL(u)}),y(s=>To({url:s})),D(s=>b(Ut({error:s}))))))),this.downloadFile$=v(()=>this.actions$.pipe(C(ke),A(({files:r})=>{let s=r.map(u=>this.vaultApiService.getFile(u.fileId).pipe(y(F=>F[0])));return Oe(s).pipe(y(u=>Ht({files:u})),D(u=>b(xo({error:u}))))}))),this.downloadFileSuccess$=v(()=>this.actions$.pipe(C(Ht),Y(({files:r})=>{r.forEach(s=>{let u=Tt(s.fileBlob,"application/pdf"),F=URL.createObjectURL(u),j=document.createElement("a");j.download=s.displayName,j.href=F,j.target="_blank",j.click()})})),{dispatch:!1}),this.initDeleteFile$=v(()=>this.actions$.pipe(C(_t),A(r=>this.dialog.open(se,{width:"40vw",height:"auto",data:{icon:"mat_outline:edit_note",title:"Delete Files",cancelButtonText:"Cancel",saveButtonText:"Confirm",dynamicComponent:$t,dynamicComponentData:{message:'<div class="flex flex-col justify-center items-center"><span class="text-gray-500">Do you really want to delete</span><span class="text-red-500 font-bold">'+r.file.map(s=>'<span class="block">'+s.displayName+"</span>").join("")+"</span></div>",obj:r.file},submitFunction:"confirmDelete",enterKeyEnabled:!1},autoFocus:!1}).afterClosed()),G(r=>!!r),Y(r=>console.log(r)),A(r=>(this.fileActions.selection.clear(),b(Jt({file:r})))))),this.deleteFile$=v(()=>this.actions$.pipe(C(Jt),z(this.store.select(R.selectSelectedFile)),A(([{file:r},s])=>{let u=r.map(F=>this.vaultApiService.deleteFile({fileId:(F||s).fileId}));return Oe(u).pipe(y(F=>(this.fileActions.selection.clear(),Qt({ids:r.map(j=>j.fileId)}))),D(F=>b(Vo({error:F}))))}))),this.setCurrentFolder$=v(()=>this.actions$.pipe(C(J),z(this.store.select(P.selectSelectedVaultId),this.store.select(q.selectCurrentFolderId)),y(([{file:r,skipNavigation:s=!1},u,F])=>{if(!s){let j={};F&&(j.folderId=F),r&&(j.fileId=r.fileId);let X=new URLSearchParams(j).toString(),Ve=X.length?"?"+X:"",Ze=`/centers/vault-center/${u}${Ve}`;this.router.navigateByUrl(Ze)}})),{dispatch:!1})}static{this.\u0275fac=function(i){return new(i||t)(M(_e),M(O),M(ve),M(pe),M(Vt),M(W),M(me),M(he))}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac})}}return t})();var Zr=(()=>{class t{constructor(e,i,n){this.actions$=e,this.store=i,this.vaultApiService=n,this.upsertFolderTrees$=v(()=>this.actions$.pipe(C(te),z(this.store.select(ze.selectEntities)),A(([{id:l},c])=>Object.keys(c).includes(String(l))?b(St({folderTree:c[l]})):this.vaultApiService.getFolderTreeJson(l).pipe(y(T=>St({folderTree:T})),D(T=>(console.log(T),b(un({error:T})))))))),this.updateFolderTree$=v(()=>this.actions$.pipe(C(Ee),A(({vaultId:l})=>this.vaultApiService.getFolderTreeJson(l).pipe(y(c=>li({folderTree:{id:l,changes:c}})),D(c=>b(hn({error:c}))))))),this.buildFolderTreeBreadcrumbs$=v(()=>this.actions$.pipe(C(St,li,Ct,xt),z(this.store.select(ze.selectEntities)),y(([l,c])=>Object.entries(c).reduce((T,[x,p])=>(T[x]=Yn(p),T),Object.create(null))),y(l=>fn({breadcrumbs:l}))))}static{this.\u0275fac=function(i){return new(i||t)(M(_e),M(O),M(ve))}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac})}}return t})();var qr=(()=>{class t{constructor(e,i,n,l,c,T,x){this.actions$=e,this.store=i,this.dialog=n,this.vaultApiService=l,this.sheet=c,this.fileActions=T,this.router=x,this.upsertFolders$=v(()=>this.actions$.pipe(C(te),z(this.store.select(q.selectAll)),A(([{id:p},r])=>{let s=r.filter(u=>u.vaultId===p);return s.length?b(ei({folders:s})):this.vaultApiService.getFolders(p).pipe(y(u=>ei({folders:u})),D(u=>b(Qo({error:u}))))}))),this.addFolder$=v(()=>this.actions$.pipe(C(Xt),z(this.store.select(P.selectCurrentVault)),A(([{folder:p}])=>this.vaultApiService.addFolder(p).pipe(ie(r=>[Wo({folder:ue(H({},r),{folderParentId:r.folderParentId.toString()})}),Ee({vaultId:r.vaultId}),te({id:p.vaultId})]),D(r=>(console.log(r),b(Jo({error:r})))))))),this.initUpdateFolder$=v(()=>this.actions$.pipe(C(Xo),A(({folder:p})=>this.sheet.open(It,{data:{element:p,type:"folder"}}).afterDismissed()),G(p=>!!p),y(p=>ii({folder:p})))),this.updateFolder$=v(()=>this.actions$.pipe(C(ii),z(this.store.select(P.selectCurrentVault)),ie(([{folder:p,preventSetCurrent:r},s])=>this.vaultApiService.addFolder(p).pipe(Y(u=>console.log(u,"newFolder")),ie(u=>{let F=u.folderId;return[Ct({folder:{id:F,changes:u}}),Ee({vaultId:s.vaultId}),te({id:u.vaultId})]}),D(u=>b(en({error:u}))))))),this.initAddFolder$=v(()=>this.actions$.pipe(C(vt),z(this.store.select(q.selectCurrentFolder),this.store.select(P.selectCurrentVault)),A(([p,r,s])=>this.dialog.open(se,{width:"30vw",height:"auto",data:{icon:"mat_outline:edit_note",title:"Create a new Folder",cancelButtonText:"Cancel",saveButtonText:"Save",dynamicComponent:Le,dynamicComponentData:{toCreate:"Folder",createInVault:s,createInFolder:r},submitFunction:"add",enterKeyEnabled:!1},autoFocus:!1}).afterClosed()),G(p=>!!p),y(p=>Xt({folder:{folderName:p.name.toUpperCase(),folderDescription:p.description?.toUpperCase(),folderParentId:String(p.parentId),vaultId:p.vaultId}})))),this.initDeleteFolder$=v(()=>this.actions$.pipe(C(gt),A(({folder:p})=>this.dialog.open(se,{width:"40vw",height:"auto",data:{icon:"mat_outline:edit_note",title:"Delete Folder",cancelButtonText:"Cancel",saveButtonText:"Confirm",dynamicComponent:$t,dynamicComponentData:{message:'<div class="flex flex-col justify-center items-center"><span class="text-gray-500">Do you really want to delete</span><span class="text-red-500 font-bold">'+p.map(r=>r.folderName)+"</span><span>and all of its files?</span></div>",obj:p.map(r=>r.folderId)},submitFunction:"confirmDelete",enterKeyEnabled:!1},autoFocus:!1}).afterClosed()),G(p=>!!p),y(p=>oi({id:p})))),this.deleteFolder$=v(()=>this.actions$.pipe(C(oi),z(this.store.select(P.selectCurrentVault),this.store.select(q.selectCurrentFolder)),A(([{id:p},r,s])=>{let u=p.map(F=>this.vaultApiService.deleteFolder(F));return Oe(u).pipe(ie(F=>(this.fileActions.selection.clear(),[xt({id:p}),Ee({vaultId:r.vaultId}),ae({folder:s})])),D(F=>b(tn({error:F}))))}))),this.setCurrentFolder$=v(()=>this.actions$.pipe(C(ae),z(this.store.select(P.selectSelectedVaultId),this.store.select(R.selectEntities)),y(([p,r,s])=>{let u=`/centers/vault-center/${r}`;p.folder?.folderId&&(u+=`?folderId=${p.folder?.folderId}`);let F=new URLSearchParams(window.location.search),j=Number(F.get("folderId"));!p.withFile&&j!==p.folder?.folderId&&this.router.navigateByUrl(u),p.withFile&&!s[p.withFile]&&this.vaultApiService.getFile(p.withFile).subscribe(X=>{this.store.dispatch(yo({file:X[0]})),this.store.dispatch(J({file:X[0]}))})})),{dispatch:!1})}static{this.\u0275fac=function(i){return new(i||t)(M(_e),M(O),M(pe),M(ve),M(Vt),M(W),M(me))}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac})}}return t})();var Qr=_(Wr());var vi=class{_document;_textarea;constructor(o,e){this._document=e;let i=this._textarea=this._document.createElement("textarea"),n=i.style;n.position="fixed",n.top=n.opacity="0",n.left="-999em",i.setAttribute("aria-hidden","true"),i.value=o,i.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(i)}copy(){let o=this._textarea,e=!1;try{if(o){let i=this._document.activeElement;o.select(),o.setSelectionRange(0,o.value.length),e=this._document.execCommand("copy"),i&&i.focus()}}catch{}return e}destroy(){let o=this._textarea;o&&(o.remove(),this._textarea=void 0)}},ps=(()=>{class t{_document=Re(zi);constructor(){}copy(e){let i=this.beginCopy(e),n=i.copy();return i.destroy(),n}beginCopy(e){return new vi(e,this._document)}static \u0275fac=function(i){return new(i||t)};static \u0275prov=oe({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),us=new Mi("CDK_COPY_TO_CLIPBOARD_CONFIG"),Jr=(()=>{class t{_clipboard=Re(ps);_ngZone=Re(ki);text="";attempts=1;copied=new Di;_pending=new Set;_destroyed;_currentTimeout;constructor(){let e=Re(us,{optional:!0});e&&e.attempts!=null&&(this.attempts=e.attempts)}copy(e=this.attempts){if(e>1){let i=e,n=this._clipboard.beginCopy(this.text);this._pending.add(n);let l=()=>{let c=n.copy();!c&&--i&&!this._destroyed?this._currentTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(l,1)):(this._currentTimeout=null,this._pending.delete(n),n.destroy(),this.copied.emit(c))};l()}else this.copied.emit(this._clipboard.copy(this.text))}ngOnDestroy(){this._currentTimeout&&clearTimeout(this._currentTimeout),this._pending.forEach(e=>e.destroy()),this._pending.clear(),this._destroyed=!0}static \u0275fac=function(i){return new(i||t)};static \u0275dir=Li({type:t,selectors:[["","cdkCopyToClipboard",""]],hostBindings:function(i,n){i&1&&V("click",function(){return n.copy()})},inputs:{text:[0,"cdkCopyToClipboard","text"],attempts:[0,"cdkCopyToClipboardAttempts","attempts"]},outputs:{copied:"cdkCopyToClipboardCopied"}})}return t})();var Xr=(()=>{class t{constructor(e,i,n){this.data=e,this.ref=i,this.elementRef=n,this.icCopy=Qr.default}onGlobalClick(e){this.elementRef.nativeElement.contains(e.target)||(e.key==="Esc"&&this.ref.dismiss(),this.ref.dismiss())}ngOnInit(){}copy(){this.ref.dismiss()}static{this.\u0275fac=function(i){return new(i||t)(g(Fo),g(ho),g($i))}}static{this.\u0275cmp=U({type:t,selectors:[["ac-direct-link-display"]],hostBindings:function(i,n){i&1&&V("mousedown",function(c){return n.onGlobalClick(c)},!1,Bt)("keydown",function(c){return n.onGlobalClick(c)},!1,Bt)},decls:6,vars:4,consts:[["id","snackbar-link",1,"flex","items-center"],[1,"ml-4","flex-auto","text-sm","leading-normal"],["color","primary","mat-button","",1,"ml-2","flex",3,"click","cdkCopyToClipboard"],["size","24px",1,"mr-2",3,"icon","inline"]],template:function(i,n){i&1&&(a(0,"div",0)(1,"p",1),I(2),m(),a(3,"button",2),V("click",function(){return n.copy()}),w(4,"ic-icon",3),I(5," Copy "),m()()),i&2&&(d(2),de(n.data.link),d(),f("cdkCopyToClipboard",n.data.link),d(),f("icon",n.icCopy)("inline",!0))},dependencies:[mt,Jr,le,re],encapsulation:2})}}return t})();var el=(()=>{class t{constructor(e,i,n,l,c,T){this.actions$=e,this.store=i,this.vaultApiService=n,this.dialog=l,this.snackbar=c,this.router=T,this.loadVaults$=v(()=>this.actions$.pipe(C($e),A(()=>this.vaultApiService.getVaults().pipe(y(x=>rn({vaults:x})),D(x=>b(ln({error:x}))))))),this.addVault$=v(()=>this.actions$.pipe(C(ri),A(({vault:x})=>this.vaultApiService.addVault(x).pipe(Y(p=>console.log(p)),ie(p=>{let r=`/centers/vault-center/${p.vaultId}`;return this.router.navigateByUrl(r),[sn({vault:p}),te({id:p.vaultId}),ti(),J({file:null,skipNavigation:!0})]}),D(p=>b(an({error:p}))))))),this.initAddVault$=v(()=>this.actions$.pipe(C(yt),A(()=>this.dialog.open(se,{width:"30vw",height:"auto",data:{icon:"mat_outline:edit_note",title:"Create a new Vault",cancelButtonText:"Cancel",saveButtonText:"Save",dynamicComponent:Le,dynamicComponentData:{toCreate:"Vault"},submitFunction:"add",enterKeyEnabled:!1},autoFocus:!1}).afterClosed()),G(x=>!!x),y(x=>ri({vault:{vaultName:x.name.toUpperCase(),vaultDescription:(x.description||"").toUpperCase()}})))),this.updateVault$=v(()=>this.actions$.pipe(C(At),A(({vault:x})=>this.vaultApiService.addVault({vaultId:Number(x.id),vaultDescription:x.changes.vaultDescription,vaultName:x.changes.vaultName}).pipe(y(p=>cn({vault:{id:p.vaultId,changes:p}})),D(p=>b(dn({error:p}))))))),this.deleteVault$=v(()=>this.actions$.pipe(C(wt),z(this.store.select(P.selectAll)),A(([{id:x},p])=>this.vaultApiService.deleteVault(x).pipe(ie(()=>{let r=p.findIndex(F=>F.vaultId===Number(x)),s=null;r>0?s=0:r===0&&(s=1);let u=s!==null?p[s].vaultId:null;return[mn({id:x}),te({id:u}),ti(),J({file:null})]}),D(r=>b(pn({error:r}))))))),this.generateDirectLink$=v(()=>this.actions$.pipe(C(bt),z(this.store.select(P.selectCurrentVault),this.store.select(q.selectCurrentFolder),this.store.select(R.selectSelectedFile)),y(([{resource:x,resourceType:p},r,s,u])=>{let F=`${window.location.origin}/centers/vault-center/`;r&&(F+=r.vaultId),p==="folder"&&(F+="?folderId="+x.folderId),p==="file"&&(F+=`?folderId=${x.folderId}&fileId=${x.fileId}`),this.snackbar.openFromComponent(Xr,{data:{link:F}})})),{dispatch:!1})}static{this.\u0275fac=function(i){return new(i||t)(M(_e),M(O),M(ve),M(pe),M(_o),M(me))}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac})}}return t})();var Ci=[Yi(Fn,_n),io([el,Zr,Yr,qr])];var vd=[{path:"",component:Ye,providers:Ci,canActivate:[ui]},{path:":vaultId",component:Ye,providers:Ci,canActivate:[ui]}];export{vd as default};
